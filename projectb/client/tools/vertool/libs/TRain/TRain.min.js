var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},cui;!function(t){var e=egret.DisplayObject.prototype;e.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();if(t.$measureChildBounds(e),t.filters){var n=t.$measureFiltersOffset(!1);e.x+=n.minX,e.y+=n.minY,e.width+=-n.minX+n.maxX,e.height+=-n.minY+n.maxY}return e},e.$onAddToStage=function(t,e){var n=this;n.$stage=t,n.$nestLevel=e,n.$hasAddToStage=!0},e.$onRemoveFromStage=function(){var t=this;t.$nestLevel=0,t.$stage=null,t.$hasAddToStage=!1};var n=function(e){function n(){var t=e.call(this)||this,n=t;return n.$BC=[0/0,0/0,0/0,0/0,0/0,0/0,0/0,0/0,!1,!1,0/0,0/0],n._invalidDL=!1,n._invalidProps=0,n.hitCheckBound=!0,n.$touchEnabled=!0,t}return __extends(n,e),n.prototype.dispose=function(){var t=this;if(!t._disposed){t.ud&&(t.ud=null),t._disposed=!0;for(var e=t.$children,n=0,r=e.length;r>n;++n)e[n].dispose()}},n.prototype.$onAddToStage=function(t,n){e.prototype.$onAddToStage.call(this,t,n);var r=this;r._inited||(r._inited=!0,r.childrenCreated()),r._invalidProps>0&&r.validateProps(),r._invalidDL&&r.invalidateDL()},n.prototype.childrenCreated=function(){this._inited=!0},Object.defineProperty(n.prototype,"anthorPerX",{get:function(){return this._anthorPerX||0},set:function(t){var e=this;e._anthorPerX=t;var n=e.$getWidth();n>0&&(e.anchorOffsetX=Math.floor(n*t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anthorPerY",{get:function(){return this._anthorPerY||0},set:function(t){var e=this;e._anthorPerY=t;var n=e.$getHeight();n>0&&(e.anchorOffsetY=Math.floor(n*t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return e.prototype.$getWidth.call(this)},set:function(t){t=+t;var e=this.$BC;e[10]!==t&&(e[10]=t,this.$setWidth(t))},enumerable:!0,configurable:!0}),n.prototype.$getExplicitWidth=function(){return this.$BC[10]},n.prototype.$setWidth=function(t){e.prototype.$setWidth.call(this,t),this.invalidateProps(2)},Object.defineProperty(n.prototype,"height",{get:function(){return e.prototype.$getHeight.call(this)},set:function(t){t=+t;var e=this.$BC;e[11]!==t&&(e[11]=t,this.$setHeight(t))},enumerable:!0,configurable:!0}),n.prototype.$getExplicitHeight=function(){return this.$BC[11]},n.prototype.$setHeight=function(t){e.prototype.$setHeight.call(this,t),this.invalidateProps(2)},Object.defineProperty(n.prototype,"filterNm",{get:function(){return this.$BC[12]},set:function(e){this.$BC[12]=e,this.filters=e&&e.length>0?t.uiMgr.getFilters(e):null},enumerable:!0,configurable:!0}),n.prototype.$childAdded=function(t,e){t.needPLayout&&this.openLayout(),this.invalidateDL()},n.prototype.$childRemoved=function(t,e){this.invalidateDL()},n.prototype.getChildAt=function(t){var e=this.$children;return t>=0&&t<e.length?e[t]:null},n.prototype.addChild=function(t){var e=this,n=e.$children.length;return t.$parent==e&&n--,e.$doAddChild(t,n,!1)},n.prototype.addChildAt=function(t,e){var n=this.$children.length;return(0>e||e>=n)&&(e=n,t.$parent==this&&e--),this.$doAddChild(t,e,!1)},n.prototype.removeChild=function(t){var e=this,n=e.$children.indexOf(t);return t=e.$doRemoveChild(n,!1),e.dispatchEventWith("rmv_child",!1),t},n.prototype.removeChildAt=function(t){var e=this;if(t>=0&&t<e.$children.length){var n=e.$doRemoveChild(t,!1);return e.dispatchEventWith("rmv_child",!1),n}return null},Object.defineProperty(n.prototype,"left",{get:function(){return this.$BC[0]},set:function(t){t=+t;var e=this.$BC;e[0]!==t&&(e[0]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$BC[2]},set:function(t){t=+t;var e=this.$BC;e[2]!==t&&(e[2]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$BC[1]},set:function(t){t=+t;var e=this.$BC;e[1]!==t&&(e[1]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$BC[3]},set:function(t){t=+t;var e=this.$BC;e[3]!=t&&(e[3]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hCenter",{get:function(){return this.$BC[4]},set:function(t){t=+t;var e=this.$BC;e[4]!==t&&(e[4]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vCenter",{get:function(){return this.$BC[5]},set:function(t){t=+t;var e=this.$BC;e[5]!==t&&(e[5]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perWidth",{get:function(){return this.$BC[6]},set:function(t){t=+t;var e=this.$BC;e[6]!==t&&(e[6]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perHeight",{get:function(){return this.$BC[7]},set:function(t){t=+t;var e=this.$BC;e[7]!==t&&(e[7]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needPLayout",{get:function(){return this.$BC[8]},enumerable:!0,configurable:!0}),n.prototype.setNeedPLayout=function(){var t=this,e=t.$BC,n=t.$parent;e[8]||(e[8]=!0,n&&n.openLayout()),n&&n.invalidateDL()},Object.defineProperty(n.prototype,"isOpenLayout",{get:function(){return this.$BC[9]},enumerable:!0,configurable:!0}),n.prototype.openLayout=function(){this.$BC[9]=!0},Object.defineProperty(n.prototype,"nestLevel",{get:function(){return this.$nestLevel},enumerable:!0,configurable:!0}),n.prototype.getPreferredBounds=function(t){var e=this,n=e.$getWidth(),r=e.$getHeight();e.applyMatrix(t,n,r)},n.prototype.applyMatrix=function(t,e,n){var r=this;t.setTo(0,0,e,n);var i=r.$getMatrix();r.isDeltaIdentity(i)?(t.x+=i.tx,t.y+=i.ty):i.$transformBounds(t)},n.prototype.isDeltaIdentity=function(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d},n.prototype.invalidateProps=function(e){var n=this;if(2==e){var r=n._anthorPerX;void 0!=r&&(n.anchorOffsetX=Math.floor(n.$getWidth()*r)),r=n._anthorPerY,void 0!=r&&(n.anchorOffsetY=Math.floor(n.$getHeight()*r))}n.$stage&&!n._invalidPropsFlag&&(n._invalidPropsFlag=!0,t.uiMgr.invalidateProperty(n)),n._invalidProps|=e},n.prototype.validateProps=function(){var t=this;0!=t._invalidProps&&t.commitProps()},n.prototype.commitProps=function(){var t=this,e=t._invalidProps;(2==(2&e)||1==(1&e))&&t.invalidateDL(),t._invalidProps=0,t._invalidPropsFlag=!1},n.prototype.validateNow=function(){var t=this;t.$BC[9]&&t.updateDL()},n.prototype.invalidateDL=function(){var e=this;if(e.$stage&&!e._invalidDLFlag){e._invalidDLFlag=!0;var n=e.$parent;n&&n.isOpenLayout&&n.invalidateDL(),t.uiMgr.invalidateDL(e)}e._invalidDL=!0},n.prototype.validateDL=function(){var t=this;t._invalidDL=!1,t._invalidDLFlag=!1,t.$BC[9]&&t.updateDL()},n.prototype.updateDL=function(){var t=this,e=t.$getWidth();if(0!=e){var n=t.$getHeight();if(0!=n)for(var r=t.$children,i=0,o=r.length;o>i;i++){var a=r[i];if(a.needPLayout){var s=a,u=s.left,l=s.right,c=s.perWidth,p=0/0;isNaN(u)||isNaN(l)?isNaN(c)||(p=Math.round(e*c*.01)):p=e-l-u,isNaN(p)?p=s.$getWidth():s.width=p;var h=0/0,d=s.top,f=s.bottom,v=s.perHeight;isNaN(d)||isNaN(f)?isNaN(v)||(h=Math.round(n*v*.01)):h=n-f-d,isNaN(h)?h=s.$getHeight():s.height=h;var g=0/0,y=0/0,_=s.hCenter,m=s.vCenter;isNaN(_)?isNaN(u)?isNaN(l)||(g=e-p-l):g=u:g=Math.round((e-p)/2+_),isNaN(m)?isNaN(d)?isNaN(f)||(y=n-h-f):y=d:y=Math.round((n-h)/2+m),isNaN(g)||(s.x=g),isNaN(y)||(s.y=y)}}}},n.prototype.$hitTest=function(t,n){var r=this;if(!r.touchEnabled||!r.visible)return null;if(r.hitCheckBound){var i=r.globalToLocal(t,n,egret.$TempPoint),o=egret.$TempRectangle.setTo(0,0,r.$getWidth(),r.$getHeight()),a=r.$scrollRect;if(a&&(o.x=a.x,o.y=a.y),!o.contains(i.x,i.y))return null}var s=e.prototype.$hitTest.call(this,t,n);return s||r.touchThrough||(s=r),s},n.prototype.$measureChildBounds=function(t){},n}(egret.DisplayObjectContainer);t.BaseContainer=n,__reflect(n.prototype,"cui.BaseContainer",["cui.IBaseContainer","cui.IBaseCtrl","cui.ILayout","egret.DisplayObject"])}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skinName",{get:function(){return this._skinName},set:function(t){var e=this,n=e._skinName;n!=t&&(e._skinName=t,e.parseSkinName())},enumerable:!0,configurable:!0}),e.prototype.parseSkinName=function(){var t,e=this,n=e.skinName;if(n)if(n.prototype)t=new n;else{var r=TRain.UITheme.getSkin(n);t=r?new r:n}e.setSkin(t)},e.prototype.setSkin=function(t){var e=this,n=e._skin;if(n){n.hostComponent=null;for(var r=n.skinParts,i=r.length,o=0;i>o;o++){var a=r[o];e[a]&&delete e[a]}var s=n.elementsContent;if(s){i=s.length;for(var o=0;i>o;o++)e.removeChild(s[o])}}if(e._skin=t,t){for(var r=t.skinParts,u=r.length,o=0;u>o;o++){var a=r[o];e[a]=t[a]}var s=t.elementsContent;if(s)for(var o=s.length-1;o>=0;o--)e.addChildAt(s[o],0);t.hostComponent=e,TRain.core.addDelayDo(e.onPartAdded,e,0)}},e.prototype.onPartAdded=function(){},Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._disabled},set:function(t){var e=this;e._disabled!==!t&&(e._disabled=!t,e.$touchEnabled=t,e.invalidateProps(4))},enumerable:!0,configurable:!0}),e.prototype.getState=function(){return""},e.prototype.commitProps=function(){var e=this,n=e._invalidProps;if(4==(4&n)){var r=e._skin;r&&r.hasStates()&&r.applyState(e.getState())}t.prototype.commitProps.call(this)},e}(t.BaseContainer);t.Component=e,__reflect(e.prototype,"cui.Component")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n.$Group=[0,0,0,0,!1],e}return __extends(e,t),Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},set:function(t){var e=this;e._layout!=t&&(e._layout&&(e._layout.target=null),e._layout=t,t&&(t.target=e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOpenLayout",{get:function(){return!!this._layout||this.$BC[9]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,n=0;e>n;n++)this.addChild(t[n])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this.$Group[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this.$Group[1]},enumerable:!0,configurable:!0}),e.prototype.setContentSize=function(t,e){var n=this,r=n.$Group;r[0]=t,r[1]=e,r=n.$BC,isNaN(r[10])&&n.$setWidth(t),isNaN(r[11])&&n.$setHeight(e)},e.prototype.getElementRect=function(t){var e=this,n=e.numElements;if(0>=n)return null;t>=n&&(t=n-1);var r=this._layout;if(r)return r.getElementRect(t);var i=null,o=this.getElementAt(t);return o&&(i={x:o.$getX(),y:o.$getY(),w:o.$getWidth(),h:o.$getHeight()}),i},e.prototype.getElementSize=function(t){var e=this,n=e.numElements;if(0>=n)return{w:0,h:0};t>=n&&(t=n-1);var r=this._layout;if(r)return r.getElementSize(t);var i={w:0,h:0},o=this.getElementAt(t);return o&&(i.w=o.$getWidth(),i.h=o.$getHeight()),i},e.prototype.getElementIdxByPos=function(t,e){var n=this.numElements;if(0>=n||0>t&&0>e)return-1;var r=this._layout;if(r)return r.getElementIdxByPos(t,e);for(var i=0;n>i;i++){var o=this.getElementAt(i);if(o){var a=o.$getX(),s=o.$getY();if(t>=a&&e>=s&&t<=a+o.$getWidth()&&e<=s+o.$getHeight())return i}}return-1},Object.defineProperty(e.prototype,"numElements",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),e.prototype.getElementAt=function(t){return this.getChildAt(t)},e.prototype.getVirtualElementAt=function(t){return this.getChildAt(t)},e.prototype.setIndicesInView=function(t,e){for(var n=0,r=this.$children;t>n;n++)r[n].$setVisible(!1);for(;e>=n;n++)r[n].$setVisible(!0);for(var i=r.length;i>n;n++)r[n].$setVisible(!1)},e.prototype.isElementInView=function(t){var e=this.getChildAt(t);return e?e.visible:!1},Object.defineProperty(e.prototype,"scrollEnabled",{get:function(){return this.$Group[4]},set:function(t){t=!!t;var e=this.$Group;t!==e[4]&&(e[4]=t,this.updateScrollRect())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollH",{get:function(){return this.$Group[2]},set:function(t){t=+t||0;var e=this,n=e.$Group;t!==n[2]&&(n[2]=t,e.invalidateDL())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollV",{get:function(){return this.$Group[3]},set:function(t){t=+t||0;var e=this,n=e.$Group;t!=n[3]&&(n[3]=t,e.invalidateDL())},enumerable:!0,configurable:!0}),e.prototype.updateScrollRect=function(){var t=this,e=t.$Group,n=e[4],r=this.$scrollRect;return n?(r?(r.x=e[2],r.y=e[3],r.width=t.$getWidth(),r.height=t.$getHeight()):r=new egret.Rectangle(e[2],e[3],t.$getWidth(),t.$getHeight()),t.scrollRect=r):this.$scrollRect&&(t.scrollRect=null),n},e.prototype.validateNow=function(){},e.prototype.validateDL=function(){var e=this,n=e._layout;n?(e._invalidDL=!1,e._invalidDLFlag=!1,n.updateDL(e.$getWidth(),e.$getHeight())):t.prototype.validateDL.call(this),e.updateScrollRect()},e}(t.BaseContainer);t.Group=e,__reflect(e.prototype,"cui.Group",["cui.IViewport"])}(cui||(cui={}));var TRain;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._refCnt=0,e}return __extends(e,t),e.prototype.$hasRef=function(){return this._refCnt>0},e.prototype.$addRef=function(){this._refCnt++},e.prototype.$subRef=function(){this._refCnt--},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.conf&&(this.conf=null)},e}(egret.Texture);t.TexData=e,__reflect(e.prototype,"TRain.TexData");var n=function(){function n(){var t=this;t._imgsetList={},t._waitGCs=[],t._texList={}}return n.prototype.releaseTex=function(t){var e=this,n=t.pname;if(n){var r=e._imgsetList[n];r.releaseBubTex(t)}else t.$subRef(),t.$hasRef()||e._waitGCs.push(t.name)},n.prototype.onTexLoadFin=function(t,n){var r,i=this;return t instanceof e?r=t:(r=new e,r.name=n,r.$bitmapData=t.$bitmapData,r.$initData(t.$bitmapX,t.$bitmapY,t.$bitmapWidth,t.$bitmapHeight,t.$offsetX,t.$offsetY,t.$sourceWidth,t.$sourceHeight,t.$sourceWidth,t.$sourceHeight),i._texList[n]=r),r},n.prototype.getTex=function(e,n,r,i){var o=this,a=e.indexOf("/")>=0;if(!a){var s=e.indexOf("@");if(s>0){var u=e.substring(0,s),l=e.substr(s+1),c=o._imgsetList[u];return c||(c=new t.ImageSet(u),o._imgsetList[u]=c),void c.getTexture(l,function(t){n.call(this,t,e)},r)}}var p=o._texList[e];if(p)return p.$addRef(),void n.call(r,p,e);i=i||"image";var h=function(t){var i;t&&(i=o.onTexLoadFin(t,e),i.$addRef()),n.call(r,i,e)};a?RES.getResByUrl(e,h,o,i):RES.getResAsync(e,h,o)},n.prototype.doGC=function(){for(var t=this,e=t._texList,n=t._waitGCs,r=0,i=n;r<i.length;r++){var o=i[r],a=e[o];a&&!a.$hasRef()&&(delete e[o],RES.destroyRes(o))}n.length=0},n.prototype.getFont=function(t,e,n){var r=function(r){e.call(n,r,t)};RES.getResByUrl(CONF.fontUrl+t+".fnt",r,n,"fnt")},n.prototype.getMultiRes=function(t,e,n,r){function i(i,u){if(o++,i){var l=t.indexOf(u);s[l]=i}else a=!1;o>=t.length&&e.call(n,a,s,r)}for(var o=0,a=!0,s=[],u=0,l=t.length;l>u;++u)RES.getResAsync(t[u],i,this)},n.prototype.getUrlRes=function(t,e){return RES.getAnalyzer(t).getRes(e)},n.prototype.destroyRes=function(t){return RES.destroyRes(t)},n.prototype.getAsset=function(t,e,n){if(RES.hasRes(t)){var r=RES.getRes(t);r?e.call(n,r,t):RES.getResAsync(t,e,n)}else e.call(n,null,t)},n.prototype.getUrlAsset=function(t,e,n,r){RES.getResByUrl(t,e,n,r)},n.prototype.getUrlAssets=function(t,e,r,i,o){function a(e,n){if(s++,e){var a=t.indexOf(n);l[a]=e}else u=!1;s>=t.length&&r.call(i,u,l,o)}for(var s=0,u=!0,l=[],c=this,p=n.texTps,h=0,d=t.length;d>h;++h){var f=e[h],v=t[h];p.indexOf(f)<0?RES.getResByUrl(v,a,c,f):c.getTex(v,a,c,f)}},n.prototype.createBitmapData=function(t,e){var n=new Image;n.src="data:image/png;base64,"+egret.Base64Util.encode(t),n.crossOrigin="*";var r=new egret.BitmapData(n);n.onload=function(){n.onload=void 0,r.source=n,r.height=n.height,r.width=n.width,e&&e(r)}},n.texTps=["image","mc"],n}();t.AssetManager=n,__reflect(n.prototype,"TRain.AssetManager"),t.assetMgr=new n}(TRain||(TRain={}));var cui;!function(t){egret.Bitmap.prototype.$setTexture=function(t){var e=this;e._sourceChanged=!1;var n=e.$texture;return t==n?!1:(e.$texture=t,t?e.$refreshImageData():e.setImageData(null,0,0,0,0,0,0,0,0,0,0),e.$renderDirty=!0,!0)};var e=function(e){function n(t){var n=e.call(this)||this,r=n;return r.$BC=[0/0,0/0,0/0,0/0,0/0,0/0,0/0,0/0,!1],r._invalidProps=0,r._sourceChanged=!1,r._source=null,r.$renderNode=new egret.sys.BitmapNode,t&&(r.source=t),n}return __extends(n,e),Object.defineProperty(n.prototype,"anthorPerX",{get:function(){return this._anthorPerX||0},set:function(t){var e=this;e._anthorPerX=t;var n=e.$getWidth();n>0&&(e.anchorOffsetX=Math.floor(n*t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anthorPerY",{get:function(){return this._anthorPerY||0},set:function(t){var e=this;e._anthorPerY=t;var n=e.$getHeight();n>0&&(e.anchorOffsetY=Math.floor(n*t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filterNm",{get:function(){return this.$BC[12]},set:function(e){this.$BC[12]=e,this.filters=e&&e.length>0?t.uiMgr.getFilters(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"source",{get:function(){return this._source},set:function(t){var e=this;t!=e._source&&(e._source=t,t?e.$stage?e.handleSourceChange():e._sourceChanged=!0:e.$setTexture(null))},enumerable:!0,configurable:!0}),n.prototype.handleSourceChange=function(){var t=this;t._sourceChanged=!1;var e=t._source;e&&TRain.assetMgr.getTex(e,t.contentChanged,t)},n.prototype.$setTexture=function(t){var e=this;e._sourceChanged=!1;var n=e.$texture;return t==n?!1:(e.$texture=t,t?(e.$refreshImageData(),e.dispatchEventWith(egret.Event.COMPLETE),e.invalidateProps(64)):e.resetBitmapData(),e.$renderDirty=!0,n&&TRain.assetMgr.releaseTex(n),!0)},n.prototype.resetBitmapData=function(){var t=this;t.$bitmapData=null,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0},n.prototype.contentChanged=function(t,e){var n=this,r=!1;e==n._source&&(r=!!n.$setTexture(t)),t&&!r&&TRain.assetMgr.releaseTex(t)},n.prototype.$onAddToStage=function(t,e){egret.DisplayObject.prototype.$onAddToStage.call(this,t,e);var n=this;n._sourceChanged&&n.handleSourceChange(),n._invalidProps>0&&n.validateProps()},n.prototype.$onRemoveFromStage=function(){egret.DisplayObject.prototype.$onRemoveFromStage.call(this)},n.prototype.dispose=function(){var t=this;t._disposed=!0;var e=t.$texture;e&&(t.$texture=null,TRain.assetMgr.releaseTex(e))},n.prototype.$setWidth=function(t){var n=e.prototype.$setWidth.call(this,t);return n&&this.invalidateProps(2),n},n.prototype.$setHeight=function(t){var n=e.prototype.$setHeight.call(this,t);return n&&this.invalidateProps(2),n},Object.defineProperty(n.prototype,"left",{get:function(){return this.$BC[0]},set:function(t){t=+t;var e=this.$BC;e[0]!==t&&(e[0]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$BC[2]},set:function(t){t=+t;var e=this.$BC;e[2]!==t&&(e[2]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$BC[1]},set:function(t){t=+t;var e=this.$BC;e[1]!==t&&(e[1]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$BC[3]},set:function(t){t=+t;var e=this.$BC;e[3]!=t&&(e[3]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hCenter",{get:function(){return this.$BC[4]},set:function(t){t=+t;var e=this.$BC;e[4]!==t&&(e[4]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vCenter",{get:function(){return this.$BC[5]},set:function(t){t=+t;var e=this.$BC;e[5]!==t&&(e[5]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perWidth",{get:function(){return this.$BC[6]},set:function(t){t=+t;var e=this.$BC;e[6]!==t&&(e[6]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perHeight",{get:function(){return this.$BC[7]},set:function(t){t=+t;var e=this.$BC;e[7]!==t&&(e[7]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needPLayout",{get:function(){return this.$BC[8]},enumerable:!0,configurable:!0}),n.prototype.setNeedPLayout=function(){var t=this,e=t.$BC,n=t.$parent;e[8]||(e[8]=!0,n&&n.openLayout()),n&&n.invalidateDL()},n.prototype.invalidateProps=function(e){var n=this;if(2==e||64==e){var r=n._anthorPerX;void 0!=r&&(n.anchorOffsetX=Math.floor(n.$getWidth()*r)),r=n._anthorPerY,void 0!=r&&(n.anchorOffsetY=Math.floor(n.$getHeight()*r))}n.$stage&&!n._invalidPropsFlag&&(n._invalidPropsFlag=!0,t.uiMgr.invalidateProperty(n)),n._invalidProps|=e},n.prototype.validateProps=function(){var t=this,e=t._invalidProps;if(0!=e){var n=t.$BC;n[8]&&t.$parent&&t.$texture&&t.$parent.invalidateDL(),t._invalidProps=0,t._invalidPropsFlag=!1}},n}(egret.Bitmap);t.Image=e,__reflect(e.prototype,"cui.Image",["cui.IBaseCtrl","cui.ILayout","egret.DisplayObject"])}(cui||(cui={}));var CMap=function(){function t(){var t=this;t._keys=[],t._values=[]}return t.prototype.set=function(t,e){var n=this,r=n._keys.indexOf(t);return r>=0?n._values[r]=e:(n._keys.push(t),n._values.push(e)),n},t.prototype.get=function(t){var e=this,n=e._keys.indexOf(t);return n>=0?e._values[n]:null},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){for(var n=this,r=n._keys,i=n._values,o=r.length,a=0;o>a;++a)t.call(e,i[a],r[a],n)},t.prototype.clear=function(){var t=this;t._keys.length=0,t._values.length=0},t.prototype.has=function(t){return this._keys.indexOf(t)>=0},t.prototype["delete"]=function(t){var e=this,n=e._keys.indexOf(t);return n>=0?(e._keys.splice(n,1),e._values.splice(n,1),!0):!1},t}();__reflect(CMap.prototype,"CMap");var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n.touchChildren=!1,n._touchCaptured=!1,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),e}return __extends(e,t),e.prototype.dispose=function(){this.onTouchFinish(),this._cb=null,t.prototype.dispose.call(this)},e.prototype.setTarget=function(t,e){this._cb={fun:t,tar:e}},e.prototype.$hitTest=function(t,e){var n=this;if(!n.touchEnabled||!n.visible)return null;var r=n.globalToLocal(t,e,egret.$TempPoint),i=egret.$TempRectangle.setTo(0,0,n.width,n.height);return i.contains(r.x,r.y)?n:null},e.prototype.onTouchBegin=function(t){var e=this;e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e);var n=e.$stage;n.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),e._tempStage=n,e._touchCaptured=!0,e.invalidateProps(4),t.updateAfterEvent()},e.prototype.onTouchEnd=function(t){var e=this;e.onTouchFinish(),t.isDefaultPrevented()||(t.preventDefault(),e.buttonReleased())},e.prototype.onTouchFinish=function(){var t=this,e=t._tempStage;e&&(e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t._touchCaptured=!1,t.invalidateProps(4))},e.prototype.getState=function(){var t=this;return t.enabled?t._touchCaptured?"down":"up":"disabled"},Object.defineProperty(e.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!0,configurable:!0}),e.prototype.buttonReleased=function(){var t=this,e=t._cb;if(e&&e.fun.call(e.tar,t),t.enabled){var n=t._sound;n&&TRain.soundMgr.playSFX(n)}},e}(t.Component);t.SimpleButton=e,__reflect(e.prototype,"cui.SimpleButton")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){var e=this;e._data=t,"width"in t&&(e.width=t.width),"height"in t&&(e.height=t.height),e._inited&&e.dataChanged()},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this;e._data&&e.dataChanged()},e.prototype.dataChanged=function(){},e}(t.Component);t.DataItem=e,__reflect(e.prototype,"cui.DataItem");var n=function(n){function r(){var t=n.call(this)||this,e=t;return e.$DataGroup=[[],null,null,null],e._range=[0,0],e._idxToItm=new CMap,t}return __extends(r,n),r.prototype.dispose=function(){var t=this;t.onRenderTouchFinish(null);var e=t.$DataGroup[3];e&&(e.removeEventListener("collect_ch",t.onCollectionChange,t),t.$DataGroup[3]=null),t.clearAllRenders(),n.prototype.dispose.call(this)},r.prototype.childrenCreated=function(){var e=this;if(!e._layout){var r=new t.DataLineLayout;r.isHorizontal=!1,e.layout=r}n.prototype.childrenCreated.call(this)},Object.defineProperty(r.prototype,"numElements",{get:function(){var t=this.$DataGroup[3];return t?t.length:0},enumerable:!0,configurable:!0}),r.prototype.getElementAt=function(t){return this._idxToItm.get(t)},r.prototype.getVirtualElementAt=function(t){var e=this,n=e.$DataGroup[3];if(0>t||t>=n.length)return null;var r=e._idxToItm,i=r.get(t);if(!i){var o=n.getItemAt(t);i=e.createRender(),i.itemIndex=t,i.data=o,r.set(t,i),e.addChild(i),e.rendererAdded(i,t,o)}return i},r.prototype.setIndicesInView=function(t,e){var n=this,r=n._range;r[0]=t,r[1]=e;var i=n._idxToItm,o=i.values,a=[],s=o.length,u=0;for(u=0;s>u;u++){var l=o[u],c=l.itemIndex;(t>c||c>e)&&(a.push(c),n.doFreeRender(l))}for(s=a.length,u=0;s>u;u++)i["delete"](a[u])},r.prototype.isElementInView=function(t){return this._idxToItm.has(t)},Object.defineProperty(r.prototype,"itemRender",{get:function(){return this.$DataGroup[1]},set:function(t){var e=this,n=e.$DataGroup;n[1]!=t&&(n[1]=t,e.invalidateProps(8))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemSkinName",{get:function(){return this.$DataGroup[2]},set:function(t){var e=this,n=e.$DataGroup;n[2]!=t&&(n[2]=t,e.invalidateProps(16))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataProvider",{get:function(){return this.$DataGroup[3]},set:function(t){var e=this,n=e.$DataGroup,r=n[3];r!=t&&(r&&r.removeEventListener("collect_ch",e.onCollectionChange,e),n[3]=t,e.invalidateProps(32))},enumerable:!0,configurable:!0}),r.prototype.onCollectionChange=function(t){var e=this;switch(t.kind){case"add":e.itemAddedHandler(t.item,t.location);break;case"remove":e.itemRemovedHandler(t.item,t.location);break;case"update":case"replace":e.itemUpdatedHandler(t.item,t.location);break;case"upidxs":e.idxsUpdatedHandler(t.item);break;case"removeAll":case"reset":case"refresh":e.freeAllRender(),e.invalidateProps(32)}},r.prototype.itemAddedHandler=function(t,e){var n=this;if(n._idxToItm.has(e))n.resetRenderIdxs(),n.invalidateDL();else{var r=n._range;r[0]<=e&&e<=r[1]&&n.invalidateDL()}},r.prototype.itemRemovedHandler=function(t,e){var n=this,r=n._idxToItm,i=r.get(e);i&&(r["delete"](e),n.doFreeRender(i),n.resetRenderIdxs(),n.invalidateDL())},r.prototype.resetRenderIdxs=function(){var t=this,e=t._idxToItm;if(0!=e.size){for(var n,r=t.$DataGroup[3],i=e.values,o=i.length,a=!1,s=0,u=0;o>u;u++)n=i[u],s=r.getItemIndex(n.data),n.itemIndex!=s&&(n.itemIndex=s,a=!0);if(a){i=i.slice(0),e.clear();for(var u=0;o>u;u++)n=i[u],e.set(n.itemIndex,n)}}},r.prototype.itemUpdatedHandler=function(t,e){var n=this._idxToItm.get(e);n&&(n.data=t)},r.prototype.idxsUpdatedHandler=function(t){for(var e=this._idxToItm,n=this.dataProvider,r=0,i=t;r<i.length;r++){var o=i[r],a=e.get(o);a&&(a.data=n.getItemAt(o))}},r.prototype.clearAllRenders=function(){var t=this,e=t._idxToItm,n=e.size;if(n>0){var r=e.values;t.removeChildren();for(var i=0;n>i;i++)r[i].dispose();e.clear()}var o=t.$DataGroup,a=o[0];if(n=a.length,n>0){for(var i=0;n>i;i++)a[i].dispose();o[0]=[]}},r.prototype.freeAllRender=function(){for(var t=this,e=t._idxToItm.values,n=0,r=e.length;r>n;++n)t.doFreeRender(e[n]);t._idxToItm.clear()},r.prototype.doFreeRender=function(t){var e=this,n=e.$DataGroup,r=n[0];r.push(t),e.rendererRemoved(t,t.itemIndex,t.data),e.removeChild(t)},r.prototype.createRender=function(){var t,n=this,r=n.$DataGroup[0];if(r&&r.length>0)t=r.pop();else{var i=n.$DataGroup[1];i||(i=e),t=new i;var o=n.$DataGroup[2];o&&(t.skinName=o)}return t},r.prototype.rendererAdded=function(t,e,n){var r=this;t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onRenderTouchBegin,r)},r.prototype.rendererRemoved=function(t,e,n){var r=this;t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onRenderTouchBegin,r)},r.prototype.onRenderTouchBegin=function(t){var e=this,n=t.$currentTarget,r=e.$stage;e._tempStage=r,e._downRender=n,n.addEventListener(egret.TouchEvent.TOUCH_END,e.onRenderTouchEnd,e),n.addEventListener(egret.TouchEvent.TOUCH_END,e.onRenderCaptureEnd,e,!0),r.addEventListener(egret.TouchEvent.TOUCH_END,e.onRenderTouchFinish,e)},r.prototype.onRenderTouchFinish=function(t){var e=this,n=e._downRender;n&&(n.removeEventListener(egret.TouchEvent.TOUCH_END,e.onRenderTouchEnd,e),n.removeEventListener(egret.TouchEvent.TOUCH_END,e.onRenderCaptureEnd,e,!0),e._tempStage.removeEventListener(egret.TouchEvent.TOUCH_END,e.onRenderTouchFinish,e),e._tempStage=null,e._downRender=null)},r.prototype.onRenderCaptureEnd=function(t){var e=this;t.isDefaultPrevented()&&e.onRenderTouchFinish(t)},r.prototype.onRenderTouchEnd=function(t){var e=this,n=e._downRender;if(n){e.onRenderTouchFinish(t);var r=t.$currentTarget;r==n&&e.dispatchEventWith("item_tap",!1,r)}},r.prototype.commitProps=function(){var t=this,e=t.$DataGroup,r=t._invalidProps,i=32==(32&r);if(i||8==(8&r)){if(t.clearAllRenders(),t.dispatchEventWith("view_clear",!1),i){var o=e[3];o&&o.addEventListener("collect_ch",t.onCollectionChange,t),t.scrollV=t.scrollH=0}t.invalidateDL()}if(16==(16&r)){var a=e[2],s=t._idxToItm.values,u=s.length,l=0;for(l=0;u>l;l++)s[l].skinName=a;var c=e[0];for(u=c.length,l=0;u>l;l++)c[l].skinName=a}n.prototype.commitProps.call(this)},r}(t.Group);t.DataGroup=n,__reflect(n.prototype,"cui.DataGroup")}(cui||(cui={}));var cui;!function(t){var e=function(){function t(){var t=this;t._target=null,t.paddingBottom=0,t.paddingTop=0,t.paddingRight=0,t.paddingLeft=0,t.itemH=0,t.itemW=0,t._startIdx=-1,t._endIdx=-1}return Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){var e=this;e._target!==t&&(e._target=t)},enumerable:!0,configurable:!0}),t.prototype.getElementIdxByPos=function(t,e){return-1},t.prototype.getElementRect=function(t){return null},t.prototype.getElementSize=function(t){var e=this;if(e.isFixedSize())return{w:e.itemW,h:e.itemH};var n=e.target.getElementAt(t);return n?{w:n.width,h:n.height}:{w:0,h:0}},t.prototype.isFixedSize=function(){return this.itemH>0&&this.itemW>0},t.prototype.checkTargetValid=function(t){if(!t||t.numElements<=0)return!1;var e=t.$getWidth(),n=t.$getHeight();return 0>=e||0>=n?!1:!0},t.prototype.scrollPositionChanged=function(){var t=this,e=t._target;if(!t.checkTargetValid(e))return void(t._startIdx=t._endIdx=-1);var n=t.adjustViewIndex(e);n&&(t._inViewCalc=!0,t.target.invalidateDL())},t.prototype.adjustViewIndex=function(t){return!1},t.prototype.updateDL=function(t,e){var n=this,r=n._target;return n.checkTargetValid(r)?(n._inViewCalc?n._inViewCalc=!1:n.adjustViewIndex(r),-1==n._startIdx||-1==n._endIdx?void r.setContentSize(Math.ceil(n.paddingLeft+n.paddingRight),Math.ceil(n.paddingTop+n.paddingBottom)):(r.setIndicesInView(n._startIdx,n._endIdx),void(n.isFixedSize()?n.updateFixSizeDList(t,e):n.updateRealDList(t,e)))):void(n._startIdx=n._endIdx=-1)},t.prototype.updateFixSizeDList=function(t,e){},t.prototype.updateRealDList=function(t,e){},t
}();t.LayoutBase=e,__reflect(e.prototype,"cui.LayoutBase")}(cui||(cui={}));var TRain;!function(t){var e=function(){function t(t,e){this._tm=0,this._doCnt=0;var n=this;n._dur=t||1,n._times=e||1,n._tm=0,n._doCnt=0}return Object.defineProperty(t.prototype,"duration",{get:function(){var t=this;return t._dur*t._times},set:function(t){this._dur=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){return this._times},set:function(t){this._times=t>0?t:1},enumerable:!0,configurable:!0}),t.prototype.isDone=function(){return this._tm>=this._dur},t.prototype.getTar=function(){return this._tar},t.prototype.start=function(t){var e=this;e._tar=t,e._tm=0,e._doCnt=1},t.prototype.stop=function(){this._tar=null},t.prototype.stopToEnd=function(){var t=this;t._tar&&(t.update(1),t._tar=null)},t.prototype.clear=function(){this._tar=null},t.prototype.step=function(t){var e=this;e._tm+=t;var n=Math.min(1,e._tm/e._dur);if(e.update(n),n>=1){var r=e.times,i=e._doCnt;r>i&&(i++,e._tm-=e._dur)}},t.prototype.update=function(t){},t}();t.Action=e,__reflect(e.prototype,"TRain.Action");var n=function(t){function e(e){var n=t.call(this)||this;return n._act=e,n}return __extends(e,t),e.prototype.isDone=function(){return!1},e.prototype.stop=function(){var t=this;t._tar=null,t._act.stop()},e.prototype.clear=function(){t.prototype.clear.call(this);var e=this._act;e&&(e.clear(),this._act=null)},e.prototype.setAction=function(t){var e=this,n=e._act;n&&n.stop(),e._act=t;var r=e._tar;r&&t&&t.start(r)},e.prototype.start=function(e){t.prototype.start.call(this,e);var n=this._act;n&&n.start(e)},e.prototype.step=function(t){var e=this,n=e._act;if(n){if(e._tm+=t,n.isDone()){var r=n.duration;t=e._tm-r,t>r&&(t%=r),e._tm=t,n.start(e._tar)}n.step(t)}},e}(e);t.ActionLoop=n,__reflect(n.prototype,"TRain.ActionLoop")}(TRain||(TRain={}));var TRain;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.getRes=function(t){return this.fileDic[t]},n.prototype.onLoadFinish=function(e){var n=this,r=e.target,i=n.resItemDic[r.$hashCode];delete n.resItemDic[r.hashCode];var o=i.item;if(o.loaded=e.type==egret.Event.COMPLETE,o.loaded){var a=r.response,s=new Uint32Array(a,0,2),u=s[0],l=s[1],c=new Uint8Array(a,8+u,l);t.assetMgr.createBitmapData(c,function(e){var r=new t.TexData;r._setBitmapData(e);var s,c,p,h=new Uint8Array(a,8,u),d=new Uint16Array(h.length);for(s=0,c=h.length;c>s;s++)p=h[s],d[s]=(p<<4&255)+(p>>4);var f,v=String.fromCharCode.apply(null,d),g=u+l+8;if(a.byteLength>g){var y=new Uint16Array(a,g);for(d=new Uint16Array(h.length),s=0,c=y.length;c>s;s++)p=y[s],d[s]=(p<<8&255)+(p>>8);f=String.fromCharCode.apply(null,d)}n.parseSpriteSheet(r,v,o.name,f),i.func.call(i.thisObject,o)})}else i.func.call(i.thisObject,o);n.recycler.push(r)},n.prototype.parseSpriteSheet=function(t,e,n,r){var i=JSON.parse(e),o=i.frames;o&&(t.name=n,t.conf=o,this.fileDic[n]=t)},n.prototype.destroyRes=function(t){var e=this.fileDic,n=e[t];return n?(delete e[t],n.dispose(),!0):!1},n}(RES.BinAnalyzer);t.SheetAnalyzer=e,__reflect(e.prototype,"TRain.SheetAnalyzer"),RES.registerAnalyzer("st",e)}(TRain||(TRain={}));var cui;!function(t){var e=function(e){function n(t){var n=e.call(this)||this,r=n;return r._fontChanged=!1,r.$BC=[0/0,0/0,0/0,0/0,0/0,0/0,0/0,0/0,!1],r._invalidProps=0,t&&r.$setText(t),n}return __extends(n,e),Object.defineProperty(n.prototype,"filterNm",{get:function(){return this.$BC[12]},set:function(e){this.$BC[12]=e,this.filters=e&&e.length>0?t.uiMgr.getFilters(e):null},enumerable:!0,configurable:!0}),n.prototype.$onAddToStage=function(t,n){e.prototype.$onAddToStage.call(this,t,n);var r=this;r._fontChanged&&r.parseFont(),r._invalidProps>0&&r.validateProps()},n.prototype.$setText=function(t){var n=e.prototype.$setText.call(this,t);return n&&this.invalidateProps(128),n},n.prototype.$setFont=function(t){var e=this;return e._font==t?!1:(e._font=t,e.$stage?e.parseFont():e._fontChanged=!0,e.$fontStringChanged=!0,!0)},n.prototype.parseFont=function(){var t=this;t._fontChanged=!1,t._font?TRain.assetMgr.getFont(t._font,t.onFontChanged,t):t.$setFontData(null)},n.prototype.onFontChanged=function(t,e){var n=this;e===n._font&&n.$setFontData(t)},n.prototype.$setFontData=function(t){var e=this;return t==e.$font?!1:(e.$font=t,""!=e.text&&(e.$invalidateContentBounds(),e.invalidateProps(64)),!0)},n.prototype.dispose=function(){this._disposed=!0},n.prototype.$setWidth=function(t){var n=e.prototype.$setWidth.call(this,t);return n&&this.invalidateProps(2),n},n.prototype.$setHeight=function(t){var n=e.prototype.$setHeight.call(this,t);return n&&this.invalidateProps(2),n},Object.defineProperty(n.prototype,"txtKey",{set:function(t){var e=TRain.langMgr.getTxtByKey(t);e&&(this.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.$BC[0]},set:function(t){t=+t;var e=this.$BC;e[0]!==t&&(e[0]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$BC[2]},set:function(t){t=+t;var e=this.$BC;e[2]!==t&&(e[2]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$BC[1]},set:function(t){t=+t;var e=this.$BC;e[1]!==t&&(e[1]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$BC[3]},set:function(t){t=+t;var e=this.$BC;e[3]!=t&&(e[3]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hCenter",{get:function(){return this.$BC[4]},set:function(t){t=+t;var e=this.$BC;e[4]!==t&&(e[4]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vCenter",{get:function(){return this.$BC[5]},set:function(t){t=+t;var e=this.$BC;e[5]!==t&&(e[5]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perWidth",{get:function(){return this.$BC[6]},set:function(t){t=+t;var e=this.$BC;e[6]!==t&&(e[6]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perHeight",{get:function(){return this.$BC[7]},set:function(t){t=+t;var e=this.$BC;e[7]!==t&&(e[7]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needPLayout",{get:function(){return this.$BC[8]},enumerable:!0,configurable:!0}),n.prototype.setNeedPLayout=function(){var t=this,e=t.$BC,n=t.$parent;e[8]||(e[8]=!0,n&&n.openLayout()),n&&n.invalidateDL()},n.prototype.invalidateProps=function(e){var n=this;n.$stage&&!n._invalidPropsFlag&&(n._invalidPropsFlag=!0,t.uiMgr.invalidateProperty(n)),n._invalidProps|=e},n.prototype.validateProps=function(){var t=this,e=t._invalidProps;if(0!=e){var n=t.$BC;n[8]&&t.$parent&&""!=t.text&&t.$parent.invalidateDL(),t._invalidProps=0,t._invalidPropsFlag=!1}},n}(egret.BitmapText);t.BitmapLabel=e,__reflect(e.prototype,"cui.BitmapLabel",["cui.IBaseCtrl","cui.ILayout","egret.DisplayObject"])}(cui||(cui={}));var EaseUtil;!function(t){function e(t){return function(e){return Math.pow(e,t)}}function n(t){return function(e){return 1-Math.pow(1-e,t)}}function r(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}function i(t){return 1-Math.cos(t*Math.PI/2)}function o(t){return Math.sin(t*Math.PI/2)}function a(t){return-.5*(Math.cos(Math.PI*t)-1)}function s(t){return function(e){return e*e*((t+1)*e-t)}}function u(t){return function(e){return--e*e*((t+1)*e+t)+1}}function l(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}function c(t){return-(Math.sqrt(1-t*t)-1)}function p(t){return Math.sqrt(1- --t*t)}function h(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}function d(t){return 1-f(1-t)}function f(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function v(t){return.5>t?.5*d(2*t):.5*f(2*t-1)+.5}function g(t,e){var n=2*Math.PI,r=e/n*Math.asin(1/t);return function(i){return 0==i||1==i?i:-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n/e))}}function y(t,e){var n=2*Math.PI,r=e/n*Math.asin(1/t);return function(i){return 0==i||1==i?i:t*Math.pow(2,-10*i)*Math.sin((i-r)*n/e)+1}}function _(t,e){var n=2*Math.PI,r=e/n*Math.asin(1/t);return function(i){return(i*=2)<1?-.5*(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n/e)):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*n/e)*.5+1}}function m(t,e){var n=2*Math.PI;return e/=100,e>1&&(e=1),function(r){var i=r*t,o=(i-Math.floor(i))*n;return Math.sin(o)*(1-e*r)}}t.getPowIn=e,t.getPowOut=n,t.getPowInOut=r,t.quadIn=e(2),t.quadOut=n(2),t.quadInOut=r(2),t.cubicIn=e(3),t.cubicOut=n(3),t.cubicInOut=r(3),t.quartIn=e(4),t.quartOut=n(4),t.quartInOut=r(4),t.quintIn=e(5),t.quintOut=n(5),t.quintInOut=r(5),t.sineIn=i,t.sineOut=o,t.sineInOut=a,t.getBackIn=s,t.backIn=s(1.7),t.getBackOut=u,t.backOut=u(1.7),t.getBackInOut=l,t.backInOut=l(1.7),t.circIn=c,t.circOut=p,t.circInOut=h,t.bounceIn=d,t.bounceOut=f,t.bounceInOut=v,t.getElasticIn=g,t.elasticIn=g(1,.3),t.getElasticOut=y,t.elasticOut=y(1,.3),t.getElasticInOut=_,t.elasticInOut=_(1,.3*1.5),t.getQuakeFun=m,t.waveRandFun=function(t){return 0===t||1===t?0:Math.random()<.5?Math.random():-Math.random()}}(EaseUtil||(EaseUtil={}));var cui;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t._isFocusIn=!1,t._promptColor=6710886;var n=t;return n.type=egret.TextFieldType.INPUT,n._isFocusIn=!1,n.$EditableText=[null,16777215,!1],n.$BC=[0/0,0/0,0/0,0/0,0/0,0/0,0/0,0/0,!1],n._invalidProps=0,t}return __extends(n,e),n.prototype.dispose=function(){this._disposed=!0},Object.defineProperty(n.prototype,"filterNm",{get:function(){return this.$BC[12]},set:function(e){this.$BC[12]=e,this.filters=e&&e.length>0?t.uiMgr.getFilters(e):null},enumerable:!0,configurable:!0}),n.prototype.$onAddToStage=function(t,n){e.prototype.$onAddToStage.call(this,t,n);var r=this;r.addEventListener(egret.FocusEvent.FOCUS_IN,r.onfocusIn,r),r.addEventListener(egret.FocusEvent.FOCUS_OUT,r.onfocusOut,r),r._invalidProps>0&&r.validateProps()},n.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var t=this;t.removeEventListener(egret.FocusEvent.FOCUS_IN,t.onfocusIn,t),t.removeEventListener(egret.FocusEvent.FOCUS_OUT,t.onfocusOut,t)},n.prototype.onfocusOut=function(){var t=this;t._isFocusIn=!1,t.text||t.showPromptText()},n.prototype.onfocusIn=function(){var t=this;t._isFocusIn=!0,t._showPrompt=!1,t.displayAsPassword=t.$EditableText[2];var e=t.$EditableText,n=t.text;n&&n!=e[0]||(t.textColor=e[1],t.text="")},n.prototype.$getText=function(){var t=e.prototype.$getText.call(this);return t==this.$EditableText[0]&&(t=""),t},n.prototype.$setText=function(t){var n=this,r=n.$EditableText[0];(r!=t||null==r)&&(n._showPrompt=!1,n.textColor=n.$EditableText[1]),n._isFocusIn||(""==t||null==t)&&(t=r,n._showPrompt=!0,e.prototype.$setTextColor.call(this,n._promptColor));var i=e.prototype.$setText.call(this,t);return i},Object.defineProperty(n.prototype,"prompt",{get:function(){return this.$EditableText[0]},set:function(t){var e=this,n=e.$EditableText,r=n[0];if(r!=t){n[0]=t;var i=e.text;i&&i!=r||e.showPromptText()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promptColor",{get:function(){return this._promptColor},set:function(t){t=0|+t;var e=this;if(e._promptColor!=t){e._promptColor=t;var n=e.text;n&&n!=e.$EditableText[0]||e.showPromptText()}},enumerable:!0,configurable:!0}),n.prototype.showPromptText=function(){var t=this,n=t.$EditableText;t._showPrompt=!0,e.prototype.$setTextColor.call(this,t._promptColor),e.prototype.$setDisplayAsPassword.call(this,!1),t.text=n[0]},n.prototype.$setTextColor=function(t){t=0|+t;var n=this;return n.$EditableText[1]=t,n._showPrompt||e.prototype.$setTextColor.call(this,t),!0},n.prototype.$setDisplayAsPassword=function(t){var n=this;return n.$EditableText[2]=t,n._showPrompt||e.prototype.$setDisplayAsPassword.call(this,t),!0},n.prototype.$setWidth=function(t){var n=e.prototype.$setWidth.call(this,t);return n&&this.invalidateProps(2),n},n.prototype.$setHeight=function(t){var n=e.prototype.$setHeight.call(this,t);return n&&this.invalidateProps(2),n},Object.defineProperty(n.prototype,"left",{get:function(){return this.$BC[0]},set:function(t){t=+t;var e=this.$BC;e[0]!==t&&(e[0]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$BC[2]},set:function(t){t=+t;var e=this.$BC;e[2]!==t&&(e[2]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$BC[1]},set:function(t){t=+t;var e=this.$BC;e[1]!==t&&(e[1]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$BC[3]},set:function(t){t=+t;var e=this.$BC;e[3]!=t&&(e[3]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hCenter",{get:function(){return this.$BC[4]},set:function(t){t=+t;var e=this.$BC;e[4]!==t&&(e[4]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vCenter",{get:function(){return this.$BC[5]},set:function(t){t=+t;var e=this.$BC;e[5]!==t&&(e[5]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perWidth",{get:function(){return this.$BC[6]},set:function(t){t=+t;var e=this.$BC;e[6]!==t&&(e[6]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perHeight",{get:function(){return this.$BC[7]},set:function(t){t=+t;var e=this.$BC;e[7]!==t&&(e[7]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needPLayout",{get:function(){return this.$BC[8]},enumerable:!0,configurable:!0}),n.prototype.setNeedPLayout=function(){var t=this,e=t.$BC,n=t.$parent;e[8]||(e[8]=!0,n&&n.openLayout()),n&&n.invalidateDL()},n.prototype.invalidateProps=function(e){var n=this;n.$stage&&!n._invalidPropsFlag&&(n._invalidPropsFlag=!0,t.uiMgr.invalidateProperty(n)),n._invalidProps|=e},n.prototype.validateProps=function(){var t=this,e=t._invalidProps;if(0!=e){var n=t.$BC;n[8]&&t.$parent&&""!=t.$getText()&&t.$parent.invalidateDL(),t._invalidProps=0,t._invalidPropsFlag=!1}},n}(egret.TextField);t.EditableText=e,__reflect(e.prototype,"cui.EditableText",["cui.IDisplayText","cui.IBaseCtrl","cui.ILayout","egret.DisplayObject"])}(cui||(cui={}));var TRain;!function(t){var e=function(){function t(){var t=this;t._unitTag=1,t._tarActs=new CMap,t._tagActs=new CMap}return t.prototype.getUnitTag=function(){return this._unitTag++},t.prototype.addAction=function(t,e,n,r){var i=this._tarActs,o=i.get(e);if(o)if(2==o.state)o.actions=[t],o.state=n?1:0;else{var a=o.actions;a.indexOf(t)<0&&a.push(t)}else o={actions:[t],tar:e,state:n?1:0},i.set(e,o);if(t.start(e),r){var a=this._tagActs.get(r);a||(a=[],this._tagActs.set(r,a)),a.push(t)}},t.prototype.rmvAction=function(t){var e=t.getTar();if(e){t.stop();var n=this._tarActs.get(e);if(n){var r=n.actions,i=r.indexOf(t);i>=0&&r.splice(i,1),0==r.length&&(n.state=2)}}},t.prototype.rmvActsByTar=function(t){var e=this._tarActs.get(t);e&&(e.state=2)},t.prototype.rmvActsByTag=function(t){var e=this._tagActs.get(t);if(e){for(var n=0,r=e.length;r>n;++n)e[n].stop();this._tagActs["delete"](t)}},t.prototype.rmvAllActs=function(){for(var t=this._tarActs.values,e=0,n=t.length;n>e;++e)t[e].state=2},t.prototype.pauseTar=function(t){var e=this._tarActs.get(t);e&&2!=e.state&&(e.state=1)},t.prototype.resumeTar=function(t){var e=this._tarActs.get(t);e&&2!=e.state&&(e.state=0)},t.prototype.pauseAll=function(){for(var t=this._tarActs.values,e=0,n=t.length;n>e;++e){var r=t[e];2!=r.state&&(r.state=1)}},t.prototype.advanceTime=function(t){var e=this,n=e._tarActs;if(!(n.size<=0)){for(var r=[],i=n.values,o=0,a=i.length;a>o;++o){var s=i[o];switch(s.state){case 0:e.updateAction(s,t);break;case 2:r.push(s.tar)}}if(r.length>0)for(o=0,a=r.length;a>o;++o)n["delete"](r[o])}},t.prototype.updateAction=function(t,e){for(var n=t.actions,r=n.length-1;r>=0;--r){var i=n[r];i.getTar()?(i.step(e),i.isDone()&&(i.stop(),n.splice(r,1))):n.splice(r,1)}0==n.length&&(t.state=2)},t}();t.ActionManager=e,__reflect(e.prototype,"TRain.ActionManager"),t.actionMgr=new e}(TRain||(TRain={}));var CONF;!function(t){t.sheetUrl="resource/sheets/",t.fontUrl="resource/fonts/",t.mcUrl="resource/mcs/",t.soundUrl="resource/sound/",t.mcGCTm=1e4,t.verFile="",t.resHome=""}(CONF||(CONF={}));var cui;!function(t){var e=function(e){function n(){var t=e.call(this)||this,n=t;return n.$BC=[0/0,0/0,0/0,0/0,0/0,0/0,0/0,0/0,!1],n.tag=-1,n._invalidProps=0,t}return __extends(n,e),n.prototype.dispose=function(){this._disposed=!0},n.prototype.$onAddToStage=function(t,n){e.prototype.$onAddToStage.call(this,t,n);var r=this;r._invalidProps>0&&r.validateProps()},n.prototype.$setWidth=function(t){var n=e.prototype.$setWidth.call(this,t);return n&&this.invalidateProps(2),n},n.prototype.$setHeight=function(t){var n=e.prototype.$setHeight.call(this,t);return n&&this.invalidateProps(2),n},Object.defineProperty(n.prototype,"txtKey",{set:function(t){var e=TRain.langMgr.getTxtByKey(t);e&&(this.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"txtFlowKey",{set:function(e){var n=TRain.langMgr.getTxtByKey(e);n&&(this.textFlow=t.htmlParser.parser(n))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filterNm",{get:function(){return this.$BC[12]},set:function(e){this.$BC[12]=e,this.filters=e&&e.length>0?t.uiMgr.getFilters(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.$BC[0]},set:function(t){t=+t;var e=this.$BC;e[0]!==t&&(e[0]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$BC[2]},set:function(t){t=+t;var e=this.$BC;e[2]!==t&&(e[2]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$BC[1]},set:function(t){t=+t;var e=this.$BC;e[1]!==t&&(e[1]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$BC[3]},set:function(t){t=+t;var e=this.$BC;e[3]!=t&&(e[3]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hCenter",{get:function(){return this.$BC[4]},set:function(t){t=+t;var e=this.$BC;e[4]!==t&&(e[4]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vCenter",{get:function(){return this.$BC[5]},set:function(t){t=+t;var e=this.$BC;e[5]!==t&&(e[5]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perWidth",{get:function(){return this.$BC[6]},set:function(t){t=+t;var e=this.$BC;e[6]!==t&&(e[6]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perHeight",{get:function(){return this.$BC[7]},set:function(t){t=+t;var e=this.$BC;e[7]!==t&&(e[7]=t,this.setNeedPLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needPLayout",{get:function(){return this.$BC[8]},enumerable:!0,configurable:!0}),n.prototype.setNeedPLayout=function(){var t=this,e=t.$BC,n=t.$parent;e[8]||(e[8]=!0,n&&n.openLayout()),n&&n.invalidateDL()},n.prototype.invalidateProps=function(e){var n=this;n.$stage&&!n._invalidPropsFlag&&(n._invalidPropsFlag=!0,t.uiMgr.invalidateProperty(n)),n._invalidProps|=e},n.prototype.validateProps=function(){var t=this,e=t._invalidProps;if(0!=e){var n=t.$BC;n[8]&&t.$parent&&""!=t.$TextField[13]&&t.$parent.invalidateDL(),t._invalidProps=0,t._invalidPropsFlag=!1}},n}(egret.TextField);t.Label=e,__reflect(e.prototype,"cui.Label",["cui.IBaseCtrl","cui.ILayout","egret.DisplayObject"])}(cui||(cui={}));var cui;!function(t){var e=function(){function t(){var t=this;t.skinParts=[],t.elementsContent=[]}return Object.defineProperty(t.prototype,"hostComponent",{get:function(){return this._host},set:function(t){var e=this;if(e._host!=t&&(e._host=t,t)){var n=e.x;n&&(t.x=n),n=e.y,n&&(t.y=n),n=e.width,n&&isNaN(t.$getExplicitWidth())&&(t.width=n),n=e.height,n&&isNaN(t.$getExplicitHeight())&&(t.height=n)}},enumerable:!0,configurable:!0}),t.prototype.hasStates=function(){return!!this.states},t.prototype.applyState=function(t){var e=this,n=e.states[t];if(n)for(var r=e._host,i=0,o=n.length;o>i;++i){var a=n[i],s=a.ctrl;""==s?r[a.prop]=a.val:e[s][a.prop]=a.val}},t}();t.Skin=e,__reflect(e.prototype,"cui.Skin")}(cui||(cui={}));var cui;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n._src=t||[],n}return __extends(n,e),Object.defineProperty(n.prototype,"source",{get:function(){return this._src},set:function(e){this._src=e,t.CollectionEvent.dispatchCoEvent(this,"reset")},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){t.CollectionEvent.dispatchCoEvent(this,"refresh")},Object.defineProperty(n.prototype,"length",{get:function(){return this._src.length},enumerable:!0,configurable:!0}),n.prototype.addItem=function(e){var n=this,r=n._src;r.push(e),t.CollectionEvent.dispatchCoEvent(n,"add",r.length-1,e)},n.prototype.addItemAt=function(e,n){var r=this,i=r._src;i.splice(n,0,e),t.CollectionEvent.dispatchCoEvent(r,"add",n,e)},n.prototype.getItemAt=function(t){return this._src[t]},n.prototype.getItemIndex=function(t){return this._src.indexOf(t)},n.prototype.itemUpdated=function(e){var n=this,r=n._src.indexOf(e);-1!=r&&t.CollectionEvent.dispatchCoEvent(n,"update",r,e)},n.prototype.updateItemAt=function(e){var n=this,r=n._src;e>=0&&e<r.length&&t.CollectionEvent.dispatchCoEvent(n,"update",e,r[e])},n.prototype.updateItemAts=function(e){t.CollectionEvent.dispatchCoEvent(this,"upidxs",0,e)},n.prototype.removeAll=function(){var e=this;e._src.length=0,t.CollectionEvent.dispatchCoEvent(e,"removeAll")},n.prototype.removeItem=function(e){var n=this,r=n._src,i=r.indexOf(e);r.splice(i,1),t.CollectionEvent.dispatchCoEvent(n,"remove",i,e)},n.prototype.removeItemAt=function(e){var n=this,r=n._src,i=r.splice(e,1)[0];return t.CollectionEvent.dispatchCoEvent(n,"remove",e,i),i},n.prototype.replaceItemAt=function(e,n){var r=this,i=r._src,o=i.splice(n,1,e)[0];return t.CollectionEvent.dispatchCoEvent(r,"replace",n,e,o),o},n}(egret.EventDispatcher);t.ArrayCollection=e,__reflect(e.prototype,"cui.ArrayCollection",["cui.ICollection","egret.IEventDispatcher"])}(cui||(cui={}));var TRain;!function(t){var e=function(){function t(){var t=this;t._timeScale=1,t._uid=0,t._delayDos=[],t._freeDelayObjs=[],t._frameDos=[],t._nextDos=[]}return t.prototype.init=function(t){var e=this;e.stage=t,t.addEventListener(egret.Event.ENTER_FRAME,e.update,e),t.addEventListener(egret.Event.ACTIVATE,e.redrawStage,e),e._lastTime=egret.getTimer(),cui.uiMgr.initState(t)},t.prototype.redrawStage=function(){this.stage.invalidate()},t.prototype.setTimeScale=function(t){this._timeScale=t},t.prototype.addNextDo=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this._nextDos.push({doFun:t,thisObj:e,args:n})},t.prototype.addDelayDo=function(t,e,n,r,i){for(var o=[],a=5;a<arguments.length;a++)o[a-5]=arguments[a];r=r||0,i=!!i;var s,u=this,l=u._delayDos,c=++u._uid,p=this._freeDelayObjs;return p.length>0?(s=p.pop(),s.flag=r,s.doFun=t,s.thisObj=e,s.delay=n,s.canScale=i,s.args=o,s.uuid=c):s={flag:r,doFun:t,thisObj:e,delay:n,canScale:i,args:o,uuid:c},l.unshift(s),c},t.prototype.freeDelayObj=function(t){var e=this._freeDelayObjs;e.length<30&&(t.doFun=null,t.thisObj=null,t.args=null,e.push(t))},t.prototype.rmvDelayDo=function(t,e){var n=this._delayDos,r=n.length;if(!(0>=r))for(var i=r-1;i>=0;--i){var o=n[i];if(o.thisObj==e&&o.doFun==t){o.thisObj=null,o.doFun=null;break}}},t.prototype.rmvAllDelayDo=function(t){var e=this._delayDos,n=e.length;if(!(0>=n))for(var r=n-1;r>=0;--r){var i=e[r];i.thisObj==t&&(i.thisObj=null,i.doFun=null)}},t.prototype.rmvDelayDoByFlag=function(t){var e=this._delayDos,n=e.length;if(!(0>=n)){t=t||0;for(var r=n-1;r>=0;--r){var i=e[r];i.flag==t&&(i.thisObj=null,i.doFun=null)}}},t.prototype.rmvDelayDoByID=function(t){var e=this._delayDos,n=e.length;if(!(0>=n))for(var r=n-1;r>=0;--r){var i=e[r];if(i.uuid==t){i.thisObj=null,i.doFun=null;break}}},t.prototype.adjustDelayTmByID=function(t,e){var n=this._delayDos,r=n.length;if(!(0>=r))for(var i=r-1;i>=0;--i){var o=n[i];if(o.uuid==t){o.delay=e;break}}},t.prototype.addFrameDo=function(t,e,n,r){n=!!n;var i=this,o=i._frameDos,a=++i._uid,s={doFun:t,thisObj:e,canScale:n,uuid:a};return r&&r>35&&(s.interval=r,s.lostTm=0),o.push(s),a},t.prototype.rmvAllFrameDo=function(){this._frameDos=[]},t.prototype.rmvFrameDoById=function(t){var e=this._frameDos,n=e.length;if(!(0>=n))for(var r=n-1;r>=0;--r){var i=e[r];if(i.uuid==t){i.doFun=null,i.thisObj=null;break}}},t.prototype.rmvFrameDo=function(t,e){var n=this._frameDos,r=n.length;if(!(0>=r)){var i,o=r-1;if(e){for(;o>=0;--o)if(i=n[o],i.thisObj==t&&i.doFun==e){i.doFun=null,i.thisObj=null;break}}else for(;o>=0;--o)i=n[o],i.thisObj==t&&(i.doFun=null,i.thisObj=null)}},t.prototype.update=function(t){var e=this,n=egret.getTimer(),r=n-e._lastTime,i=Math.floor(r*e._timeScale);e._lastTime=n;var o,a=e._nextDos,s=a.length;if(s>0)for(e._nextDos=[],o=0;s>o;++o){var u=a[o];u.doFun.apply(u.thisObj,u.args)}var l=e._delayDos;if(s=l.length,s>0)for(o=s-1;o>=0;--o){var c=l[o];c.doFun?(c.delay-=c.canScale?i:r,c.delay<=0&&(l.splice(o,1),c.doFun.apply(c.thisObj,c.args),e.freeDelayObj(c))):(l.splice(o,1),e.freeDelayObj(c))}var p=e._frameDos;if(s=p.length,s>0)for(o=s-1;o>=0;--o){var h=p[o];if(h.doFun){var d=h.canScale?i:r,f=h.interval;if(f){var v=h.lostTm+d;h.lostTm=v,v>=f&&(h.lostTm=v%f,h.doFun.call(h.thisObj,v))}else h.doFun.call(h.thisObj,d)}else p.splice(o,1)}},t}();t.Core=e,__reflect(e.prototype,"TRain.Core"),t.core=new e}(TRain||(TRain={}));var cui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){var e=this;e._label=t;var n=e.skLabel;n&&(n.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"txtKey",{get:function(){return this._txtKey},set:function(t){var e=this;e._txtKey=t;var n=e.skLabel;n&&(n.txtKey=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){var e=this;e._icon=t;var n=e.skIcon;n&&(n.source=t)},enumerable:!0,configurable:!0}),e.prototype.onPartAdded=function(){var t=this,e=t.skIcon,n=t._icon;n&&e&&(e.source=n);var r=t.skLabel;if(r){var i=t._label;if(i)r.text=i;else{var o=t._txtKey;o&&(r.txtKey=o)}}},e}(t.SimpleButton);t.Button=e,__reflect(e.prototype,"cui.Button")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return __extends(e,t),e.prototype.clean=function(){t.prototype.clean.call(this),this.item=this.oldItem=null},e.prototype.initTo=function(t,e,n,r){this.kind=t,this.location=0|+e,this.item=n,this.oldItem=r},e.dispatchCoEvent=function(t,n,r,i,o){if(!t.hasEventListener("collect_ch"))return!0;var a=egret.Event.create(e,"collect_ch");a.initTo(n,r,i,o);var s=t.dispatchEvent(a);return egret.Event.release(a),s},e}(egret.Event);t.CollectionEvent=e,__reflect(e.prototype,"cui.CollectionEvent")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.keepSelect=!1,e.activeCheckEnable=!0;var n=e;return n._items=[],n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),e}return __extends(e,t),e.prototype.dispose=function(){var e=this;e.onTouchFinish(),e._cb=null,t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"selectItem",{get:function(){return this._selection},set:function(t){var e=this;e.keepSelect&&e._selection!=t&&(e.setSelectItem(t),t&&e.activate(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectTag",{get:function(){var t=this;return t._selection?t._selection.tag:-1},set:function(t){var e=this;if(e.keepSelect&&(!e._selection||e._selection.tag!==t)){var n=e.getChildByTag(t);n&&(e.setSelectItem(n),e.activate(n))}},enumerable:!0,configurable:!0}),e.prototype.setSelectItem=function(t){var e=this;e._selection&&(e._selection.selected=!1),e._selection=t,e._selection&&(e._selection.selected=!0)},Object.defineProperty(e.prototype,"numItems",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e.prototype.getMenuItemAt=function(t){var e=this;return t>=0&&t<e.numItems?e._items[t]:null},e.prototype.getChildByTag=function(t){for(var e,n=this,r=n._items,i=0,o=r.length;o>i;++i)if(e=r[i],e.tag===t)return e;return null},e.prototype.getItemIndex=function(t){return this._items.indexOf(t)},e.prototype.setTarget=function(t,e){this._cb={fun:t,tar:e}},e.prototype.activate=function(t){var e=this._cb;e&&e.fun.call(e.tar,t)},e.prototype.$childAdded=function(e,r){t.prototype.$childAdded.call(this,e,r);var i=this;e instanceof n&&i._items.push(e)},e.prototype.$childRemoved=function(e,r){t.prototype.$childRemoved.call(this,e,r);var i=this;if(e instanceof n){var o=e;o==i._selection&&(i._selection=null);var a=i._items;a.splice(a.indexOf(e),1)}},e.prototype.$hitTest=function(t,e){var n=this;if(!n.touchEnabled||!n.visible)return null;var r=n.globalToLocal(t,e,egret.$TempPoint),i=egret.$TempRectangle.setTo(0,0,n.width,n.height),o=n.$scrollRect;return o&&(i.x=o.x,i.y=o.y),i.contains(r.x,r.y)?n:null},e.prototype.onTouchBegin=function(t){var e=this;e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e);var n=e.$stage;n.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),n.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e._tempStage=n,e._highLightItem=e._itemForTouch(t.localX,t.localY),e._highLightItem&&(e._highLightItem.selected=!0,t.updateAfterEvent())},e.prototype.onTouchMove=function(t){var e=this,n=e.globalToLocal(t.stageX,t.stageY,egret.$TempPoint),r=e._itemForTouch(n.x,n.y);e._highLightItem!=r&&(e._highLightItem&&(e.keepSelect&&e._highLightItem==e._selection||(e._highLightItem.selected=!1)),e._highLightItem=r,e._highLightItem&&(e._highLightItem.selected=!0),t.updateAfterEvent()),t.stopPropagation()},e.prototype.onTouchEnd=function(t){var e=this;e.onTouchFinish();var n=e._highLightItem;n&&(e._highLightItem=null,e.keepSelect?n!=e._selection&&e.setSelectItem(n):n.selected=!1,n.onItemTap(),e.activate(n),t.preventDefault())},e.prototype.onTouchFinish=function(){var t=this,e=t._tempStage;e&&(e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t._tempStage=null)},e.prototype._itemForTouch=function(t,e){var n=this._items;if(n.length>0){var r=n.length-1,i=void 0;if(this.activeCheckEnable){for(;r>=0;--r)if(i=n[r],i.visible&&i.enabled&&i.ptInRange(t,e))return i}else for(;r>=0;--r)if(i=n[r],i.visible&&i.ptInRange(t,e))return i}return null},e}(t.Group);t.MenuGroup=e,__reflect(e.prototype,"cui.MenuGroup");var n=function(t){function e(){var e=t.call(this)||this,n=e;return n._isSel=!1,n._enabled=!0,n.touchEnabled=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._isSel},set:function(t){this._isSel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!0,configurable:!0}),e.prototype.onItemTap=function(){var t=this;t.enabled&&TRain.soundMgr.playSFX(t._sound)},e.prototype.ptInRange=function(t,e){var n=this,r=n.x-n.anchorOffsetX,i=n.y-n.anchorOffsetY;return t>r&&t<r+n.width&&e>i&&e<i+n.height},e}(t.Component);t.MenuItem=n,__reflect(n.prototype,"cui.MenuItem");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label
},set:function(t){var e=this;e._label=t;var n=e.skLabel;n&&(n.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"txtKey",{get:function(){return this._txtKey},set:function(t){var e=this;e._txtKey=t;var n=e.skLabel;n&&(n.txtKey=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){var e=this;e._icon=t;var n=e.skIcon;n&&(n.source=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._isSel},set:function(t){var e=this;e._isSel!=t&&(e._isSel=t,e.invalidateProps(4))},enumerable:!0,configurable:!0}),e.prototype.getState=function(){var t=this;return t.enabled?t._isSel?"down":"up":"disabled"},e.prototype.onPartAdded=function(){var t=this,e=t.skIcon,n=t._icon;n&&e&&(e.source=n);var r=t.skLabel;if(r){var i=t._label;if(i)r.text=i;else{var o=t._txtKey;o&&(r.txtKey=o)}}},e}(n);t.MenuItemImage=r,__reflect(r.prototype,"cui.MenuItemImage")}(cui||(cui={}));var cui;!function(t){var e=function(e){function n(){var n=e.call(this)||this,r=n;return r._dir="ltr",r._ani=new t.Animation(r.aniUpdateHandler,r),r._aniVal=0,n}return __extends(n,e),n.prototype.dispose=function(){this._valToLabel=null,e.prototype.dispose.call(this)},n.prototype.childrenCreated=function(){this._inited=!0,this.update()},Object.defineProperty(n.prototype,"labelFunction",{set:function(t){this._valToLabel=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"direction",{get:function(){return this._dir},set:function(t){var e=this;e._dir!=t&&(e._dir=t,e._inited&&e.update())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"thumb",{get:function(){return this._thumb},set:function(t){var e=this;e._thumb=t,t&&(e._thumbPos={x:t.x,y:t.y})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this._val||0},set:function(t){0>t?t=0:t>1&&(t=1);var e=this;e._ani.isPlaying&&e._ani.stop(),e.setCurValue(t)},enumerable:!0,configurable:!0}),n.prototype.setProgressValue=function(t,e){0>t?t=0:t>1&&(t=1);var n=this;n.openAni&&e>0?n.startAni(t,e):(n._ani.isPlaying&&n._ani.stop(),n.setCurValue(t))},n.prototype.startAni=function(t,e){var n=this,r=n._ani;r.stop(),r.duration=e,r.from=n.value,r.to=t,r.play()},n.prototype.aniUpdateHandler=function(t){this.setCurValue(t.currentValue)},n.prototype.setCurValue=function(t){var e=this;e._val!=t&&(e._val=t,e.update())},n.prototype.update=function(){var t=this,e=t.value,n=t._thumb;if(n){var r=n.width,i=n.height,o=Math.round(e*r);(0>o||o===1/0)&&(o=0);var a=Math.round(e*i);(0>a||a===1/0)&&(a=0);var s=n.$scrollRect;switch(s||(s=egret.$TempRectangle),s.setTo(0,0,r,i),t._dir){case"ltr":s.width=o;break;case"rtl":s.width=o,s.x=r-o,n.x=t._thumbPos.x+s.x;break;case"ttb":s.height=a;break;case"btt":s.height=a,s.y=i-a,n.y=t._thumbPos.y+s.y}n.scrollRect=s}t.updateLabel(e)},n.prototype.updateLabel=function(t){var e=this,n=String(t);e._valToLabel&&(n=e._valToLabel(t));var r=e.skLabel;r&&(r.text=n)},n}(t.Component);t.ProgressBar=e,__reflect(e.prototype,"cui.ProgressBar")}(cui||(cui={}));var TRain;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(t){t>=1&&this["do"]()},e.prototype["do"]=function(){},e}(t.Action);t.ActionDo=e,__reflect(e.prototype,"TRain.ActionDo");var n=function(t){function e(e,n){var r=t.call(this,e)||this;return r._props=n,r}return __extends(e,t),e.prototype.setProps=function(t){this._props=t},e.prototype.addProp=function(t,e){var n=this._props;n||(n={},this._props=n),n[t]=e},e.prototype["do"]=function(){var t=this._tar,e=this._props;for(var n in e)t[n]=e[n]},e}(e);t.ActionPropDo=n,__reflect(n.prototype,"TRain.ActionPropDo");var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.once=!0,e}return __extends(e,t),e.prototype.setCall=function(t,e){this._cb={fun:t,tar:e}},e.prototype.clear=function(){var t=this;t._tar=null,t._cb=null},e.prototype.stop=function(){var t=this;t._tar=null,t.once&&(t._cb=null)},e.prototype.stopToEnd=function(){var t=this;t._tar&&(t["do"](),t._tar=null)},e.prototype["do"]=function(){var t=this,e=t._cb;e&&(e.fun.call(e.tar,t._tar),t.once&&(t._cb=null))},e}(e);t.ActionCallDo=r,__reflect(r.prototype,"TRain.ActionCallDo")}(TRain||(TRain={}));var cui;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t._bounces=!0;var n=t;return n.$Scroller=["auto","auto",!1,!1,{x:0,y:0},!1,null,null,1,null,null],n._bounces=!0,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),t}return __extends(n,e),n.prototype.dispose=function(){var t=this;t.clearEvent();var n=t.$Scroller;n[9]=null;var r=n[6];r&&(r.dispose(),n[6]=null),r=n[7],r&&(r.dispose(),n[7]=null);var i=t._hAnimation;i&&(i.stop(),i.updateFunction=null),i=t._vAnimation,i&&(i.stop(),i.updateFunction=null),e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"bounces",{get:function(){return this._bounces},set:function(t){var e=this;this._bounces=t;var n=e.$Scroller[6];n&&(n.$bounces=t);var r=e.$Scroller[7];r&&(r.$bounces=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollPolicyV",{get:function(){return this.$Scroller[0]},set:function(t){var e=this,n=e.$Scroller;n[0]!=t&&(n[0]=t,e.checkScrollPolicy())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollPolicyH",{get:function(){return this.$Scroller[1]},set:function(t){var e=this,n=e.$Scroller;n[1]!=t&&(n[1]=t,e.checkScrollPolicy())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"throwSpeed",{get:function(){var t=this.$Scroller[6];return t?t.$scrollFactor:0},set:function(t){t=+t,t=.01>t?.01:t;var e=this;this.$Scroller[8]=t;var n=e.$Scroller[6];n&&(n.$scrollFactor=t),n=e.$Scroller[7],n&&(n.$scrollFactor=t)},enumerable:!0,configurable:!0}),n.prototype.setScrollTop=function(t,e){var n=this.$Scroller;if(n[9]){var r=n[10];r||(r={},n[10]=r),r.top={v:t,d:e},this.invalidateDL()}},n.prototype.setScrollLeft=function(t,e){var n=this.$Scroller;if(n[9]){var r=n[10];r||(r={},n[10]=r),r.left={v:t,d:e},this.invalidateDL()}},n.prototype.doScrollTo=function(){var e=this,n=e.$Scroller,r=n[10];if(r&&(n[10]=null,e.checkScrollPolicy())){var i=n[9];if(i){var o=r.top;if(o&&n[3]&&i.contentHeight>i.height){var a=o.v,s=i.contentHeight-i.height;if(a>s&&(a=s),i.scrollV!=a){var u=e.getTouchScrollV();if(u.isStarted())return;var l=e._vAnimation;if(!l){var c=function(t){e.verticalUpdateHandler(t.currentValue)};l=new t.Animation(c,e),e._vAnimation=l}l.stop();var p=o.d||0;p>0?(l.duration=p,l.from=i.scrollV,l.to=a,l.play()):i.scrollV=a}}var h=r.left;if(h&&n[2]&&i.contentWidth>i.width){var d=h.v,s=i.contentWidth-i.width;if(d>s&&(d=s),i.scrollH!=d){var u=e.getTouchScrollH();if(u.isStarted())return;var l=e._hAnimation;if(!l){var c=function(t){e.horizontalUpdateHandler(t.currentValue)};l=new t.Animation(c,e),e._hAnimation=l}l.stop();var p=h.d||0;p>0?(l.duration=p,l.from=i.scrollH,l.to=d,l.play()):i.scrollH=d}}}}},n.prototype.getTouchScrollV=function(){var e=this.$Scroller,n=e[7];if(!n){var r=this;n=new t.TouchScroll(r.verticalUpdateHandler,r.verticalEndHanlder,r),n.stop(),e[7]=n,n.$scrollFactor=e[8]}return n},n.prototype.getTouchScrollH=function(){var e=this.$Scroller,n=e[6];if(!n){var r=this;n=new t.TouchScroll(r.horizontalUpdateHandler,r.horizontalEndHandler,r),n.stop(),e[6]=n,n.$scrollFactor=e[8]}return n},Object.defineProperty(n.prototype,"viewport",{get:function(){return this.$Scroller[9]},set:function(t){var e=this,n=e.$Scroller;if(t!=n[9]){var r=n[9];r&&e.uninstallViewport(),t&&e.installViewport(t)}},enumerable:!0,configurable:!0}),n.prototype.installViewport=function(t){var e=this;t.scrollEnabled=!0,e.$Scroller[9]=t,e.addChild(t),t.addEventListener("view_clear",e.onViewClear,e)},n.prototype.uninstallViewport=function(){var t=this,e=t.$Scroller,n=e[6];n&&n.stop(),n=e[7],n&&n.stop();var r=e[9];r.scrollEnabled=!1,e[9]=null,t.removeChild(r)},n.prototype.onViewClear=function(){var t=this,e=t.$Scroller,n=e[6];n&&n.stop(),n=e[7],n&&n.stop();var r=t._hAnimation;r&&r.stop(),r=t._vAnimation,r&&r.stop()},n.prototype.validateDL=function(){this.doScrollTo(),e.prototype.validateDL.call(this)},n.prototype.checkScrollPolicy=function(){var t=this.$Scroller,e=t[9];if(!e)return!1;var n=!1;switch(t[1]){case"auto":n=e.contentWidth>e.width;break;case"on":n=!0}t[2]=n;var r=!1;switch(t[0]){case"auto":r=e.contentHeight>e.height;break;case"on":r=!0}return t[3]=r,n||r},n.prototype.onTouchBegin=function(t){var e=this;if(e.checkScrollPolicy()){var n=e.$Scroller,r=n[6];r&&r.stop(),r=n[7],r&&r.stop();var i=t.$stageX,o=t.$stageY,a=e.$Scroller[4];a.x=i,a.y=o;var s=e.$stage;e._tempStage=s,s.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),s.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchCaptureEnd,e,!0),e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e)}},n.prototype.onTouchMove=function(t){t.stopImmediatePropagation();var e=this,r=t.$stageX,i=t.$stageY,o=e.$Scroller;if(!o[5]){var a=o[4];if(Math.abs(a.x-r)<n.scrollThreshold&&Math.abs(a.y-i)<n.scrollThreshold)return;o[5]=!0,e.moveStart(a.x,a.y)}e.moveUpdate(r,i)},n.prototype.onTouchCaptureEnd=function(t){var e=this;if(t.isDefaultPrevented())return void e.onTouchFinish(t);var n=e.$Scroller[5];n&&(t.preventDefault(),e.onTouchFinish(t))},n.prototype.onTouchFinish=function(t){var e=this;e.clearEvent();var n=e.$Scroller;n[5]&&(e.moveEnd(t.stageX,t.stageY),n[5]=!1)},n.prototype.clearEvent=function(){var t=this,e=t._tempStage;e&&(t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchCaptureEnd,t,!0),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),t._tempStage=null)},n.prototype.moveStart=function(t,e){var n=this,r=n._hAnimation;r&&r.stop(),r=n._vAnimation,r&&r.stop();var i,o=n.$Scroller,a=o[9];a.$UIComponent;o[2]&&(i=n.getTouchScrollH(),i.stop(),i.start(t)),o[3]&&(i=n.getTouchScrollV(),i.stop(),i.start(e))},n.prototype.moveUpdate=function(t,e){var n,r=this,i=r.$Scroller,o=i[9];i[2]&&(n=r.getTouchScrollH(),n.isStarted()&&n.update(t,o.contentWidth-o.width,o.scrollH)),i[3]&&(n=r.getTouchScrollV(),n.isStarted()&&n.update(e,o.contentHeight-o.height,o.scrollV))},n.prototype.moveEnd=function(t,e){var n,r=this,i=r.$Scroller,o=i[9];i[2]&&(n=r.getTouchScrollH(),n.isStarted()&&n.finish(o.scrollH,o.contentWidth-o.width)),i[3]&&(n=r.getTouchScrollV(),n.isStarted()&&n.finish(o.scrollV,o.contentHeight-o.height))},n.prototype.horizontalUpdateHandler=function(t){this.$Scroller[9].scrollH=t},n.prototype.verticalUpdateHandler=function(t){this.$Scroller[9].scrollV=t},n.prototype.horizontalEndHandler=function(){},n.prototype.verticalEndHanlder=function(){},n.scrollThreshold=5,n}(t.Group);t.Scroller=e,__reflect(e.prototype,"cui.Scroller")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n._states={},n._curState=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"stateStr",{set:function(t){for(var e,n=this,r=t.split(","),i=n._states,o=0;o<r.length;++o)e=r[o].split(":"),2==e.length&&(i[e[0]]=e[1]);var a=n._curState;a&&(n.source=i[a])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curState",{set:function(t){var e=this;e._curState!=t&&(e._curState=t,e.source=e._states[t])},enumerable:!0,configurable:!0}),e.prototype.addState=function(t,e){this._states[t]=e},e}(t.Image);t.StateImage=e,__reflect(e.prototype,"cui.StateImage")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.activeInView=!1,e.canOutBound=!0,e.repeatClk=!1;var n=e;return n.$TableScroller=["auto","auto",!1,!1,{x:0,y:0},{x:0,y:0},!1,null,null,null],n._lastActiveIdx=-1,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),e}return __extends(e,t),Object.defineProperty(e.prototype,"scrollPolicyV",{get:function(){return this.$TableScroller[0]},set:function(t){var e=this.$TableScroller;e[0]!=t&&(e[0]=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollPolicyH",{get:function(){return this.$TableScroller[1]},set:function(t){var e=this.$TableScroller;e[1]!=t&&(e[1]=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this.$TableScroller[9]},set:function(t){var e=this,n=e.$TableScroller;if(t!=n[9]){var r=n[9];r&&e.uninstallViewport(),t&&e.installViewport(t)}},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;e._cb=null,e.clearEvent(),TRain.actionMgr.rmvActsByTar(e),t.prototype.dispose.call(this)},e.prototype.installViewport=function(t){var e=this;t.scrollEnabled=!0,e.$TableScroller[9]=t,e.addChild(t),t.addEventListener("view_clear",e.onViewClear,e)},e.prototype.uninstallViewport=function(){var t=this;t._showInfo=null;var e=t.$TableScroller,n=e[9],r=e[7];r&&TRain.actionMgr.rmvAction(r);var i=e[8];i&&TRain.actionMgr.rmvAction(i),n.scrollEnabled=!1,e[9]=null,t.removeChild(n)},e.prototype.onViewClear=function(){var t=this.$TableScroller,e=t[7];e&&e.stop(),e=t[8],e&&e.stop()},e.prototype.showTableInViewStart=function(t,e){var n=this;n._showInfo={idx:t,ani:e},n.invalidateDL()},e.prototype._showTable=function(t,e){var n=this;if(n.checkScrollPolicy()){var r=n.viewport,i=r.getElementRect(t);if(i){var o,a,s,u=n.$TableScroller[2];if(u){a=i.x,s=r.scrollH;var l=r.width;if(s>a||a+i.w>s+l){var c=r.contentWidth;c>l&&a+l>c&&(a=c-l),e?(o=n.getAnimationDuration(.5,s,a),n.setScrollLeft(a,o)):r.scrollH=a}}else{a=i.y,s=r.scrollV;var p=r.height;if(s>a||a+i.h>s+p){var h=r.contentHeight;h>p&&a+p>h&&(a=h-p),e?(o=n.getAnimationDuration(.5,s,a),n.setScrollTop(a,o)):r.scrollV=a}}n.activeInView&&n.activate(t)}}},e.prototype.activate=function(t){var e=this,n=e._cb;return!e.repeatClk&&e._lastActiveIdx==t||!n?!1:(e._lastActiveIdx=t,n.fun.call(n.tar,t),!0)},e.prototype.setTarget=function(t,e){this._cb={fun:t,tar:e}},e.prototype.checkScrollPolicy=function(){var t=this,e=t.viewport;if(!e)return!1;var n=t.$TableScroller,r=!1;switch(n[1]){case"auto":r=e.contentWidth>e.width;break;case"on":r=!0}n[2]=r;var i=!1;if(!r){switch(n[0]){case"auto":i=e.contentHeight>e.height;break;case"on":i=!0}n[3]=i}return r||i},e.prototype.onTouchBegin=function(t){var e=this;if(e.checkScrollPolicy()){var n=t.$stageX,r=t.$stageY,i=e.$TableScroller[4];i.x=n,i.y=r;var o=e.$stage;o.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),o.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),e._tempStage=o,e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchCaptureEnd,e,!0);var a=e.$TableScroller[5];a.x=n,a.y=r}},e.prototype.onTouchMove=function(t){var n=this;t.stopPropagation();var r=n.viewport,i=r.globalToLocal(t.$stageX,t.$stageY,egret.$TempPoint);if(i.x-=r.scrollH,i.y-=r.scrollV,!(i.x<0||i.y<0||i.x>r.width||i.y>r.height)){var o=t.$stageX,a=t.$stageY,s=n.$TableScroller;if(!n.canOutBound){var u=void 0,l=void 0;if(s[2]){if(u=n.$TableScroller[5],l=t.$stageX-u.x,l>=0&&r.scrollH<=0)return;if(0>=l){var c=r.contentWidth-r.width;if(r.scrollH>=c)return}}else if(s[3]){if(l=t.$stageY-u.y,l>=0&&r.scrollV<=0)return;if(0>=l){var p=r.contentHeight-r.height;if(r.scrollV>=p)return}}}if(!s[6]){var h=s[4];if(Math.abs(h.x-o)<e.scrollThreshold&&Math.abs(h.y-a)<e.scrollThreshold)return;s[6]=!0,n.moveStart()}n.moveUpdate(o,a)}},e.prototype.onTouchCaptureEnd=function(t){var e=this;if(t.isDefaultPrevented())return void e.onTouchFinish(t);var n=e.$TableScroller[6];n&&(t.preventDefault(),e.onTouchFinish(t))},e.prototype.onTouchEnd=function(t){var e=this;if(t.isDefaultPrevented())return void e.onTouchFinish(t);if(e.onTouchFinish(t),e._cb){t.preventDefault();var n=e.globalToLocal(t.$stageX,t.$stageY,egret.$TempPoint),r=e.viewport,i=-1,o=void 0;e.$TableScroller[2]?(o=n.x+r.scrollH,o>0&&o<r.contentWidth&&(i=r.getElementIdxByPos(o,n.y))):(o=n.y+r.scrollV,o>0&&o<r.contentHeight&&(i=r.getElementIdxByPos(n.x,o))),i>=0&&e.activate(i)&&t.preventDefault()}},e.prototype.onTouchFinish=function(t){var e=this;e.clearEvent();var n=e.$TableScroller;n[6]&&(e.moveEnd(t.stageX,t.stageY),n[6]=!1)},e.prototype.clearEvent=function(){var t=this,e=t._tempStage;e&&(t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchCaptureEnd,t,!0),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),t._tempStage=null)},e.prototype.moveStart=function(){},e.prototype.moveUpdate=function(t,e){var n=this,r=n.$TableScroller[5],i={x:t,y:e};n.getPointChange(i,r,i),n.setScrollPosition(i.y,i.x,!0),r.x=t,r.y=e},e.prototype.getPointChange=function(t,e,n){var r=this;return n||(n={x:0,y:0}),r.$TableScroller[2]?(n.x=e.x-t.x,n.y=0):r.$TableScroller[3]&&(n.x=0,n.y=e.y-t.y),n},e.prototype.moveEnd=function(t,e){var n=this,r=n.viewport,i=r.numElements;if(!(0>=i)){var o=n.$TableScroller[2],a=0,s=r.getElementIdxByPos(r.scrollH,r.scrollV);if(s>=0){var u=0,l=0,c=0,p=0,h=n.$TableScroller[4],d=r.getElementRect(s);if(o){if(u=h.x-t,1>=u&&u>=-1)return;c=r.contentWidth,p=r.width,l=d.w,a=d.x}else{if(u=h.y-e,1>=u&&u>=-1)return;c=r.contentHeight,p=r.height,l=d.h,a=d.y}if(c>p){var f=Math.abs(u)/l>.2;(i-1>s&&u>0&&f||0>u&&!f)&&(a+=l,s++),a+p>c&&(a=c-p)}else a=0,s=-1}o?n.setScrollLeft(a,n.getAnimationDuration(.5,r.scrollH,a)):n.setScrollTop(a,n.getAnimationDuration(.5,r.scrollV,a)),s>=0&&n.activeInView&&n.activate(s)}},e.prototype.setScrollPosition=function(t,e,n){void 0===n&&(n=!1);var r=this.viewport;if(n){if(0===t&&0===e)return}else if(r.scrollV===t&&r.scrollH===e)return;var i=r.scrollV,o=r.scrollH;if(n){if(0!=t){var a=r.contentHeight-r.height;(0>=i||i>=a)&&(t=.5*t),r.scrollV=i+t}if(0!=e){var s=r.contentWidth-r.width;(0>=o||o>=s)&&(e=.5*e),r.scrollH=o+e}}else r.scrollV=t,r.scrollH=e},e.prototype.setScrollTop=function(t,e){void 0===e&&(e=0);var n=this,r=n.viewport;if(e>0){var i=n.$TableScroller[8];i||(i=new TRain.ActionPropTween,i.setEaseFun(EaseUtil.quartOut),n.$TableScroller[8]=i),i.addProp("scrollV",r.scrollV,t),i.duration=e,TRain.actionMgr.addAction(i,r,!1)}else r.scrollV=t},e.prototype.setScrollLeft=function(t,e){void 0===e&&(e=0);var n=this,r=n.viewport;if(e>0){var i=n.$TableScroller[7];i||(i=new TRain.ActionPropTween,i.setEaseFun(EaseUtil.quartOut),n.$TableScroller[7]=i),i.addProp("scrollH",r.scrollH,t),i.duration=e,TRain.actionMgr.addAction(i,r,!1)}else r.scrollH=t},e.prototype.getAnimationDuration=function(t,e,n){var r=Math.abs(n-e);return 10>=r?0:r/t},e.prototype.validateDL=function(){var e=this,n=e._showInfo;n&&(e._showTable(n.idx,n.ani),e._showInfo=null),t.prototype.validateDL.call(this)},e.scrollThreshold=5,e}(t.Group);t.TableScroller=e,__reflect(e.prototype,"cui.TableScroller")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.anitp=0,e.autoPlay=!1;var n=e;n._runing=!1,n._reverse=!1,n._stopFrame=0/0;var r=new TRain.MovieClip;return n._clip=r,r.addEventListener(egret.Event.COMPLETE,n.onAniFin,n),n.addChild(r),e}return __extends(e,t),e.prototype.$hitTest=function(t,e){return null},Object.defineProperty(e.prototype,"aniName",{get:function(){return this._aniName},set:function(t){var e=this;t=t?t:null,e._aniName!=t&&(e._aniName=t,e.freeClipData(),t&&e._inited&&e.loadMCData())},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this;e._aniName&&e.loadMCData()},e.prototype.dispose=function(){var e=this;e.freeClipData();var n=e._clip;n.dispose(),n.removeEventListener(egret.Event.COMPLETE,e.onAniFin,e),t.prototype.dispose.call(this)},e.prototype.$onAddToStage=function(e,n){t.prototype.$onAddToStage.call(this,e,n);var r=this;r._clipData&&r._runing&&TRain.mcMgr.add(r._clip)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this);var e=this;e._clipData&&e._runing&&TRain.mcMgr.remove(e._clip)},e.prototype.loadMCData=function(){var t=this,e=t._aniName,n=e.indexOf(".");0>n?TRain.mcMgr.getMCDataAsync(t.anitp,e,t.onLoadDataFinish,t):TRain.mcMgr.getMCDataAsync(t.anitp,e.substr(0,n),t.onLoadDataFinish,t,e.substring(n+1))},e.prototype.onLoadDataFinish=function(t,e){if(t){var n=this;if(e!=n.anitp)return void TRain.mcMgr.freeMCData(n.anitp,t);var r=n._aniName;if(null!=r){var i=r.indexOf("."),o=0>i?t.resName:t.resName+"."+t.aniName;if(r!=o)return void TRain.mcMgr.freeMCData(n.anitp,t);if(n._clipData=t,n._reverse){var a=t.clone(!0);n._reverseData=a,t=a}n._clip.movieClipData=t;var s=n._playData;if(s)n.play(s.frame,s.playTimes);else if(n.autoPlay)n.play();else if(!isNaN(n._stopFrame)){var u=n._clip;u.gotoAndStop(n._stopFrame),n.stage&&n._runing&&TRain.mcMgr.remove(u),n._runing=!1}n.dispatchEventWith("created",!1),n.invalidateDL()}}},e.prototype.reverseChanged=function(t){var e=this;e._reverse=t;var n;t?(n=e._reverseData,n||(n=e._clipData.clone(!0))):n=e._clipData,e._clip.movieClipData=n},e.prototype.gotoAndPlay=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=!1);var r=this,i=r._clipData;i?(r._reverse!=n&&r.reverseChanged(n),r.play(t,e)):(r._reverse=n,r._playData={frame:t,playTimes:e})},e.prototype.play=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0/0);var n=this;n._runing=!0;var r=n._clip;r.gotoAndPlay(t,e),n.stage&&TRain.mcMgr.add(r)},e.prototype.gotoAndStop=function(t,e){void 0===e&&(e=!1);var n=this,r=n._clipData;if(r){n._reverse!=e&&n.reverseChanged(e);var i=n._clip;i.gotoAndStop(t),n.stage&&n._runing&&TRain.mcMgr.remove(i),n._runing=!1}else n._stopFrame=t},e.prototype.stop=function(){var t=this,e=t._clip;e&&t._runing&&(t._runing=!1,e.stop(),t.stage&&TRain.mcMgr.remove(e))},e.prototype.onAniFin=function(t){var e=this;e._runing=!1;var n=e._clip;TRain.mcMgr.remove(n),e.dispatchEventWith("play_fin",!1)},e.prototype.freeClipData=function(){var t=this,e=t._clipData;e&&(t.stop(),t._reverseData=null,t._clipData=null,t._clip.movieClipData=null,TRain.mcMgr.freeMCData(t.anitp,e))},e}(t.BaseContainer);t.UIMovieClip=e,__reflect(e.prototype,"cui.UIMovieClip")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n.tag=0,n.ud=null,e}return __extends(e,t),e.prototype.dispose=function(){var e=this;e.onTouchFinish(),e._cb=null,t.prototype.dispose.call(this)},e.prototype.hasProp=function(t){return!1},e.prototype.dataChanged=function(){var t=this,e=t._data;for(var n in e)t.hasProp(n)&&(t[n]=e[n])},e.prototype.setTarget=function(t,e){var n=this;n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),n._cb={fun:t,tar:e}},e.prototype.onTouchBegin=function(t){var e=this;e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e);var n=e.$stage;n.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),e._tempStage=n,t.updateAfterEvent()},e.prototype.onTouchEnd=function(t){var e=this;e.onTouchFinish(),t.isDefaultPrevented()||(t.preventDefault(),e.clkReleased())},e.prototype.onTouchFinish=function(){var t=this,e=t._tempStage;e&&(e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t._tempStage=null)},e.prototype.clkReleased=function(){var t=this._cb;t&&t.fun.call(t.tar,this)},e}(t.DataItem);t.UITile=e,__reflect(e.prototype,"cui.UITile")}(cui||(cui={}));var cui;!function(t){var e=function(){function t(){this._queues=[]}return t.prototype.insert=function(t){for(var e,n=this,r=t.nestLevel,i=n._queues,o=0,a=i.length;a>o;++o){var s=i[o],u=s.depth;if(u==r){e=s;break}if(u>r)break}e||(e={items:[],depth:r},i.splice(o,0,e)),e.items.push(t)},t.prototype.forEachItemDo=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=this._queues,i=r.length-1;i>=0;--i)for(var o=r[i].items,a=0,s=o.length;s>a;++a){var u=o[a];u[t].apply(u,e)}},t.prototype.hasItem=function(){return this._queues.length>0},t}();__reflect(e.prototype,"DepthQueue");var n=function(){function t(){var t=this;t._filters={},t._invalidDL=new e,t._invalidProps=[]}return t.prototype.initState=function(t){var e=this;t.addEventListener(egret.Event.ENTER_FRAME,e.update,e),t.addEventListener(egret.Event.RENDER,e.update,e)},t.prototype.invalidateDL=function(t){this._invalidDL.insert(t)},t.prototype.invalidateProperty=function(t){this._invalidProps.push(t)},t.prototype.createFilters=function(t){var e=this._filters;for(var n in t){var r=t[n],i=[];e[n]=i;for(var o=0,a=r.length;a>o;++o){var s=r[o],u=null;switch(s.tp){case 1:u=new egret.GlowFilter(s.c,s.a,s.bx,s.by,s.s,s.q,s.i,s.k);break;case 2:u=new egret.ColorMatrixFilter(s.m);break;case 3:u=new egret.DropShadowFilter(s.d,s.an,s.c,s.a,s.bx,s.by,s.s,s.q,s.i,s.k)}u&&i.push(u)}}},t.prototype.getFilters=function(t){return this._filters[t]},t.prototype.update=function(t){var n=this,r=n._invalidProps,i=r.length;if(i>0){n._invalidProps=new Array;for(var o=0;i>o;++o)r[o].validateProps()}var a=n._invalidDL;a.hasItem()&&(n._invalidDL=new e,a.forEachItemDo("validateDL"))},t}();t.UIManager=n,__reflect(n.prototype,"cui.UIManager"),t.uiMgr=new t.UIManager}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHorizontal=!0,e.gap=0,e.horizontalAlign="left",e.verticalAlign="top",e}return __extends(e,t),e.prototype.getElementRect=function(t){var e,n=this,r=n._target,i=n.target.dataProvider,o=0,a=0,s=r.contentWidth,u=r.contentHeight,l=n.gap,c=r.getElementAt(t);if(c)return e=i.getItemAt(t),n.isHorizontal?(o=c.x,s=e.width+l):(a=c.y,u=e.height+l),{x:o,y:a,w:s,h:u};if(n.isFixedSize())n.isHorizontal?(s=n.itemW+l,o=s*t+n.paddingLeft):(u=n.itemH+l,a=u*t+n.paddingTop);else if(n.isHorizontal){o=n.paddingLeft;for(var p=0;t>p;p++)e=i.getItemAt(p),o+=e.width+l;e=i.getItemAt(t),s=e.width+l}else{a=n.paddingTop;for(var p=0;t>p;p++)e=i.getItemAt(p),a+=e.height+l;e=i.getItemAt(t),u=e.height+l}return{x:o,y:a,w:s,h:u}},e.prototype.getElementIdxByPos=function(t,e){var n=this,r=-1,i=n.gap,o=n.target.dataProvider,a=o.length;if(n.isFixedSize())r=n.isHorizontal?t>n.paddingLeft?Math.floor((t-n.paddingLeft)/(n.itemW+i)):0:e>n.paddingTop?Math.floor((e-n.paddingTop)/(n.itemH+i)):0;else{var s=0,u=void 0;n._target;if(n.isHorizontal){for(;a>s;s++)if(u=o.getItemAt(s),t-=u.width,0>=t){r=s;break}}else for(;a>s;s++)if(u=o.getItemAt(s),e-=u.height,0>=e){r=s;break}}return r>=a&&(r=a-1),r},e.prototype.getElementSize=function(t){var e=this;if(e.isFixedSize())return{w:e.itemW,h:e.itemH};var n=e.target.dataProvider.getItemAt(t);return{w:n.width,h:n.height}},e.prototype.adjustViewIndex=function(t){var e=this,n=t.$getWidth(),r=t.$getHeight();return e.isHorizontal?e.adjustViewIndexH(t,n,r):e.adjustViewIndexV(t,n,r)},e.prototype.adjustViewIndexH=function(t,e,n){var r=this,i=0,o=0,a=r.gap,s=t.scrollH,u=s+e-r.paddingRight,l=r.paddingLeft,c=0,p=t.dataProvider,h=p.length;if(r.isFixedSize()){var d=r.itemW+a;s>l&&(i=Math.floor((s-l)/d),i>=h&&(i=h-1)),u>l&&(o=Math.floor((u-l)/d),o>=h&&(o=h-1))}else{var f=void 0,v=0;if(s>l)for(;h>v;v++){if(f=p.getItemAt(v),c=l+f.width+a,c>s){i=v;break}l=c}for(;h>v&&(f=p.getItemAt(v),l+=f.width+a,o=v,!(l>=u));v++);}var g=r._startIdx,y=r._endIdx;return r._startIdx=i,r._endIdx=o,g!=i||y!=o},e.prototype.adjustViewIndexV=function(t,e,n){var r=this,i=0,o=0,a=r.gap,s=t.scrollV,u=s+n-r.paddingBottom,l=r.paddingTop,c=0,p=t.dataProvider,h=p.length;if(r.isFixedSize()){var d=r.itemH+a;s>l&&(i=Math.floor((s-l)/d),i>=h&&(i=h-1)),u>l&&(o=Math.floor((u-l)/d),o>=h&&(o=h-1))}else{var f=void 0,v=0;if(s>l)for(;h>v;v++){if(f=p.getItemAt(v),c=l+f.height+a,c>s){i=v;break}l=c}for(;h>v&&(f=p.getItemAt(v),l+=f.height+a,o=v,!(l>=u));v++);}var g=r._startIdx,y=r._endIdx;return r._startIdx=i,r._endIdx=o,g!=i||y!=o},e.prototype.updateFixSizeDList=function(t,e){var n=this,r=n._target;n.isHorizontal?n.updateFixSizeH(r):n.updateFixSizeV(r)},e.prototype.updateRealDList=function(t,e){var n=this,r=n._target;n.isHorizontal?n.updateDLH(r):n.updateDLV(r)},e.prototype.updateFixSizeH=function(t){for(var e=this,n=t.dataProvider,r=e.itemW+e.gap,i=e.paddingLeft+e.paddingRight+r*n.length,o=e.paddingTop+e.paddingBottom+e.itemH,a=e._startIdx,s=e._endIdx,u=e.paddingLeft+r*a,l=e.paddingTop,c=a;s>=c;c++){var p=t.getVirtualElementAt(c);p.x=u,p.y=l,u+=r}t.setContentSize(i,o)},e.prototype.updateDLH=function(t){for(var e,n=this,r=t.dataProvider,i=n.gap,o=0,a=r.length,s=n.paddingLeft+n.paddingRight,u=n.paddingTop+n.paddingBottom;a>o;o++)e=r.getItemAt(o),s+=e.width+i,u=Math.max(u,e.height);var l=n._startIdx,c=n._endIdx,p=n.paddingLeft,h=0;for(o=0;l>o;o++)e=r.getItemAt(o),p=p+e.width+i;var d=t.$getHeight(),f=n.paddingTop;if(n.verticalAlign==egret.HorizontalAlign.CENTER)for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),h=f+(d-e.height)/2,v.x=p,v.y=h,p+=e.width+i}else if(n.verticalAlign==egret.VerticalAlign.BOTTOM)for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),h=d-e.height-f,v.x=p,v.y=h,p+=e.width+i}else for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),v.x=p,v.y=f,p+=e.width+i}t.setContentSize(s,u)},e.prototype.updateFixSizeV=function(t){for(var e=this,n=t.dataProvider,r=e.itemH+e.gap,i=e.paddingLeft+e.paddingRight+e.itemW,o=e.paddingTop+e.paddingBottom+r*n.length,a=e._startIdx,s=e._endIdx,u=e.paddingTop+a*r,l=e.paddingLeft,c=a;s>=c;c++){var p=t.getVirtualElementAt(c);p.x=l,p.y=u,u+=r}t.setContentSize(i,o)},e.prototype.updateDLV=function(t){for(var e,n=this,r=t.dataProvider,i=n.gap,o=0,a=r.length,s=n.paddingLeft+n.paddingRight,u=n.paddingTop+n.paddingBottom;a>o;o++)e=r.getItemAt(o),u+=e.height+i,s=Math.max(s,e.width);var l=n._startIdx,c=n._endIdx,p=0,h=n.paddingTop;for(o=0;l>o;o++)e=r.getItemAt(o),h=h+e.height+i;var d=t.$getWidth(),f=n.paddingLeft;if(n.horizontalAlign==egret.HorizontalAlign.CENTER)for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),p=f+(d-e.width)/2,v.x=p,v.y=h,h+=e.height+i}else if(n.horizontalAlign==egret.HorizontalAlign.RIGHT)for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),p=d-e.width-f,v.x=p,v.y=h,h+=e.height+i}else for(;c>=o;o++){var v=t.getVirtualElementAt(o);e=r.getItemAt(o),v.x=f,v.y=h,h+=e.height+i}t.setContentSize(s,u)},e}(t.LayoutBase);t.DataLineLayout=e,__reflect(e.prototype,"cui.DataLineLayout")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHorizontal=!0,e.gap=0,e.horizontalAlign="left",e.verticalAlign="top",e}return __extends(e,t),e.prototype.getElementRect=function(t){var e=this,n=e._target,r=0,i=0,o=n.contentHeight,a=n.contentWidth,s=e.gap,u=n.getElementAt(t);if(u.visible)e.isHorizontal?(r=u.x,a=u.width+s):(i=u.y,o=u.height+s);else{var l=0;if(e.isHorizontal)for(r=e.paddingLeft,a=u.width+s;t>l;l++)u=n.getElementAt(l),r+=u.width+s;else for(i=e.paddingLeft,o=u.height+s;t>l;l++)u=n.getElementAt(l),i+=u.height+s}return{x:r,y:i,w:a,h:o}},e.prototype.getElementIdxByPos=function(t,e){var n=this,r=-1,i=n.gap,o=n._target,a=o.numElements;if(n.isFixedSize())r=n.isHorizontal?t>n.paddingLeft?Math.floor((t-n.paddingLeft)/(n.itemW+i)):0:e>n.paddingTop?Math.floor((e-n.paddingTop)/(n.itemH+i)):0;else{var s=0,u=void 0;if(n.isHorizontal){for(;a>s;s++)if(u=o.getElementAt(s),t-=u.width+i,0>=t){r=s;break}}else for(;a>s;s++)if(u=o.getElementAt(s),e-=u.height+i,0>=e){r=s;break}}return r>=a&&(r=a-1),r},e.prototype.adjustViewIndex=function(t){var e=this,n=t.$getWidth(),r=t.$getHeight();return e.isHorizontal?e.adjustViewIndexH(t,n,r):e.adjustViewIndexV(t,n,r)},e.prototype.adjustViewIndexH=function(t,e,n){var r,i=this,o=0,a=0,s=i.gap,u=t.scrollH,l=u+e-i.paddingRight,c=i.paddingLeft,p=0,h=t.numChildren;if(i.isFixedSize()){var d=i.itemW+s;u>c&&(o=Math.floor((u-c)/d),o>=h&&(o=h-1)),l>c&&(a=Math.floor((l-c)/d),a>=h&&(a=h-1))}else{var f=0;if(u>c)for(;h>f;f++){if(r=t.getElementAt(f),p=c+r.$getWidth()+s,p>u){o=f;break}c=p}for(;h>f&&(r=t.getElementAt(f),c+=r.$getWidth()+s,a=f,!(c>=l));f++);}var v=i._startIdx,g=i._endIdx;
return i._startIdx=o,i._endIdx=a,v!=o||g!=a},e.prototype.adjustViewIndexV=function(t,e,n){var r,i=this,o=0,a=0,s=i.gap,u=t.scrollV,l=u+n-i.paddingBottom,c=i.paddingTop,p=0,h=t.numChildren;if(i.isFixedSize()){var d=i.itemH+s;u>c&&(o=Math.floor((u-c)/d),o>=h&&(o=h-1)),l>c&&(a=Math.floor((l-c)/d),a>=h&&(a=h-1))}else{var f=0;if(u>c)for(;h>f;f++){if(r=t.getElementAt(f),p=c+r.$getHeight()+s,p>u){o=f;break}c=p}for(;h>f&&(r=t.getElementAt(f),c+=r.$getHeight()+s,a=f,!(c>=l));f++);}var v=i._startIdx,g=i._endIdx;return i._startIdx=o,i._endIdx=a,v!=o||g!=a},e.prototype.updateFixSizeDList=function(t,e){var n=this;n.isHorizontal?n.updateFixSizeH(n._target):n.updateFixSizeV(n._target)},e.prototype.updateRealDList=function(t,e){var n=this;n.isHorizontal?n.updateDLH(n._target):n.updateDLV(n._target)},e.prototype.updateFixSizeH=function(t){for(var e=this,n=e.itemW+e.gap,r=e.paddingLeft+e.paddingRight+n*t.numElements,i=e.paddingTop+e.paddingBottom+e.itemH,o=e._startIdx,a=e._endIdx,s=e.paddingLeft+n*o,u=e.paddingTop,l=o;a>=l;l++){var c=t.getElementAt(l);c.x=s,c.y=u,s+=n}t.setContentSize(r,i)},e.prototype.updateDLH=function(t){for(var e,n=this,r=n.gap,i=0,o=t.numElements,a=n.paddingLeft+n.paddingRight,s=n.paddingTop+n.paddingBottom;o>i;i++)e=t.getElementAt(i),a+=e.width+r,s=Math.max(s,e.height);var u=n._startIdx,l=n._endIdx,c=n.paddingLeft,p=0;for(i=0;u>i;i++)e=t.getElementAt(i),c=c+e.width+r;var h=t.$getHeight(),d=n.paddingTop;if(n.verticalAlign==egret.HorizontalAlign.CENTER)for(;l>=i;i++)e=t.getElementAt(i),p=d+(h-e.height)/2,e.x=c,e.y=p,c+=e.width+r;else if(n.verticalAlign==egret.VerticalAlign.BOTTOM)e=t.getElementAt(i),p=h-d-e.height,e.x=c,e.y=p,c+=e.width+r;else for(;l>=i;i++)e=t.getElementAt(i),e.x=c,e.y=d,c+=e.width+r;t.setContentSize(a,s)},e.prototype.updateFixSizeV=function(t){for(var e=this,n=e.itemH+e.gap,r=e.paddingLeft+e.paddingRight+e.itemW,i=e.paddingTop+e.paddingBottom+n*t.numElements,o=e._startIdx,a=e._endIdx,s=e.paddingTop+o*n,u=e.paddingLeft,l=o;a>=l;l++){var c=t.getElementAt(l);c.x=u,c.y=s,s+=n}t.setContentSize(r,i)},e.prototype.updateDLV=function(t){for(var e,n=this,r=n.gap,i=0,o=t.numElements,a=n.paddingLeft+n.paddingRight,s=n.paddingTop+n.paddingBottom;o>i;i++)e=t.getElementAt(i),s+=e.height+r,a=Math.max(a,e.width);var u=n._startIdx,l=n._endIdx,c=0,p=n.paddingTop;for(i=0;u>i;i++)e=t.getElementAt(i),p=p+e.height+r;var h=t.$getWidth(),d=n.paddingLeft;if(n.horizontalAlign==egret.HorizontalAlign.CENTER)for(;l>=i;i++)e=t.getElementAt(i),c=d+(h-e.width)/2,e.x=c,e.y=p,p+=e.height+r;else if(n.horizontalAlign==egret.HorizontalAlign.RIGHT)e=t.getElementAt(i),c=h-d-e.width,e.x=c,e.y=p,p+=e.height+r;else for(;l>=i;i++)e=t.getElementAt(i),e.x=d,e.y=p,p+=e.height+r;t.setContentSize(a,s)},e}(t.LayoutBase);t.LineLayout=e,__reflect(e.prototype,"cui.LineLayout")}(cui||(cui={}));var cui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHorizontal=!0,e.horizontalGap=0,e.verticalGap=0,e._count=0,e}return __extends(e,t),e.prototype.getElementRect=function(t){var e=this,n=e._target,r=0,i=0,o=e.itemW+e.horizontalGap,a=e.itemH+e.verticalGap,s=n.getElementAt(t);if(s&&s.visible)return e.isHorizontal?r=s.x:i=s.y,{x:r,y:i,w:o,h:a};var u=e._count,l=Math.floor(t/u),c=t-l*u;return e.isHorizontal?(l>0&&(r=o*l+e.paddingLeft),c>0&&(i=a*c+e.paddingTop)):(c>0&&(r=a*c+e.paddingLeft),l>0&&(i=o*l+e.paddingTop)),{x:r,y:i,w:o,h:a}},e.prototype.getItemIdxByPos=function(t,e){var n=this,r=-1,i=n._target.numElements;if(n.isFixedSize()&&t>n.paddingLeft&&e>n.paddingTop){var o=n.itemW+n.horizontalGap,a=n.itemH+n.verticalGap,s=Math.floor((t-n.paddingLeft)/o),u=Math.floor((e-n.paddingTop)/a);r=n.isHorizontal?s*n._count+u:u*n._count+s}return r>=i&&(r=i-1),r},e.prototype.adjustViewIndex=function(t){var e=this;if(e.itemH<=0||e.itemW<=0)return e._startIdx=e._endIdx=-1,!1;var n=t.$getWidth(),r=t.$getHeight();return e.isHorizontal?e.adjustViewIndexH(t,n,r):e.adjustViewIndexV(t,n,r)},e.prototype.adjustViewIndexH=function(t,e,n){var r=this,i=r.verticalGap,o=Math.floor((n-r.paddingTop-r.paddingBottom+i)/(r.itemH+i));r._count=o;var a=r.paddingLeft,s=0,u=0,l=r.itemW+r.horizontalGap,c=t.scrollH;c>a&&(s=Math.floor((c-a)/l));var p=t.scrollH+e-r.paddingRight;p>a&&(u=Math.floor((p-a)/l));var h=s*o,d=u*o+o-1,f=t.numElements;h>=f&&(h=f-1),d>=f&&(d=f-1);var v=r._startIdx,g=r._endIdx;return r._startIdx=h,r._endIdx=d,v!=h||g!=d},e.prototype.adjustViewIndexV=function(t,e,n){var r=this,i=r.horizontalGap,o=Math.floor((e-r.paddingLeft-r.paddingRight+i)/(r.itemW+i));r._count=o;var a=r.paddingTop,s=0,u=0,l=r.itemH+r.verticalGap,c=t.scrollV;c>a&&(s=Math.floor((c-a)/l));var p=t.scrollV+n-r.paddingBottom;p>a&&(u=Math.floor((p-a)/l));var h=s*o,d=u*o+o-1,f=t.numElements;h>=f&&(h=f-1),d>=f&&(d=f-1);var v=r._startIdx,g=r._endIdx;return r._startIdx=h,r._endIdx=d,v!=h||g!=d},e.prototype.updateFixSizeDList=function(t,e){var n=this;n.isHorizontal?n.updateFixSizeH(n._target):n.updateFixSizeV(n._target)},e.prototype.updateRealDList=function(t,e){},e.prototype.updateFixSizeH=function(t){for(var e=this,n=e.paddingTop,r=e._count,i=t.numElements,o=e.itemW+e.horizontalGap,a=e.itemH+e.verticalGap,s=Math.ceil(i/r),u=e.paddingLeft+e.paddingRight+o*s,l=n+e.paddingBottom+e.itemH,c=Math.floor(e._startIdx/r),p=Math.floor(e._endIdx/r),h=e.paddingLeft+o*c,d=0,f=0,v=c;p>v;v++){f=v*r,d=n;for(var g=0;r>g;g++){var y=t.getVirtualElementAt(f+g);y.x=h,y.y=d,d+=a}h+=o}f=p*r;var _=f+r;_>i&&(_=i),d=n;for(var g=f;_>g;g++){var y=t.getVirtualElementAt(g);y.x=h,y.y=d,d+=a}t.setContentSize(u,l)},e.prototype.updateFixSizeV=function(t){for(var e=this,n=e.paddingLeft,r=e._count,i=t.numElements,o=e.itemW+e.horizontalGap,a=e.itemH+e.verticalGap,s=Math.ceil(i/r),u=e.paddingLeft+e.paddingRight+e.itemW,l=n+e.paddingBottom+a*s,c=Math.floor(e._startIdx/r),p=Math.floor(e._endIdx/r),h=0,d=e.paddingTop+a*c,f=0,v=c;p>v;v++){f=v*r,h=n;for(var g=0;r>g;g++){var y=t.getVirtualElementAt(f+g);y.x=h,y.y=d,h+=o}d+=a}f=p*r;var _=f+r;_>i&&(_=i),h=n;for(var g=f;_>g;g++){var y=t.getVirtualElementAt(g);y.x=h,y.y=d,h+=o}t.setContentSize(u,l)},e}(t.LayoutBase);t.TileLayout=e,__reflect(e.prototype,"cui.TileLayout")}(cui||(cui={}));var cui;!function(t){var e=function(){function t(t,e){this.easerFunction=EaseUtil.sineInOut,this.isPlaying=!1,this.duration=500,this.currentValue=0,this.from=0,this.to=0,this.startTime=0,this.endFunction=null,this.updateFunction=t,this.thisObject=e}return t.prototype.play=function(){this.stop(),this.start()},t.prototype.start=function(){this.isPlaying=!1,this.currentValue=0,this.startTime=egret.getTimer(),this.doInterval(this.startTime),egret.startTick(this.doInterval,this)},t.prototype.stop=function(){this.isPlaying=!1,this.startTime=0,egret.stopTick(this.doInterval,this)},t.prototype.dispose=function(){this.updateFunction=null,this.endFunction=null,this.thisObject=null},t.prototype.doInterval=function(t){var e=t-this.startTime;this.isPlaying||(this.isPlaying=!0);var n=this.duration,r=0==n?1:Math.min(e,n)/n;this.easerFunction&&(r=this.easerFunction(r)),this.currentValue=this.from+(this.to-this.from)*r,this.updateFunction&&this.updateFunction.call(this.thisObject,this);var i=e>=n;return i&&this.stop(),i&&this.endFunction&&this.endFunction.call(this.thisObject,this),!0},t}();t.Animation=e,__reflect(e.prototype,"cui.Animation")}(cui||(cui={}));var cui;!function(t){var e=4,n=[1,1.33,1.66,2],r=2.33,i=.02,o=.998,a=.95,s=Math.log(o),u=function(){function u(e,n,r){this.$scrollFactor=1,this.previousTime=0,this.velocity=0,this.previousVelocity=[],this.currentPosition=0,this.previousPosition=0,this.currentScrollPos=0,this.maxScrollPos=0,this.offsetPoint=0,this.$bounces=!0,this.disposed=!1,this.started=!0,this.updateFunction=e,this.endFunction=n,this.target=r,this.animation=new t.Animation(this.onScrollingUpdate,this),this.animation.endFunction=this.finishScrolling,this.animation.easerFunction=EaseUtil.cubicOut}return u.prototype.isPlaying=function(){return this.animation.isPlaying},u.prototype.stop=function(){this.animation.stop(),egret.stopTick(this.onTick,this),this.started=!1},u.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.animation.dispose(),egret.stopTick(this.onTick,this),this.started=!1,this.updateFunction=null,this.endFunction=null,this.target=null)},u.prototype.isStarted=function(){return this.started},u.prototype.start=function(t){this.started=!0,this.velocity=0,this.previousVelocity.length=0,this.previousTime=egret.getTimer(),this.previousPosition=this.currentPosition=t,this.offsetPoint=t,egret.startTick(this.onTick,this)},u.prototype.update=function(t,e,n){e=Math.max(e,0),this.currentPosition=t,this.maxScrollPos=e;var r=this.offsetPoint-t,i=r+n;this.offsetPoint=t,0>i&&(this.$bounces?i-=.5*r:i=0),i>e&&(this.$bounces?i-=.5*r:i=e),this.currentScrollPos=i,this.updateFunction.call(this.target,i)},u.prototype.finish=function(t,e){egret.stopTick(this.onTick,this),this.started=!1;for(var u=this.velocity*r,l=this.previousVelocity,c=l.length,p=r,h=0;c>h;h++){var d=n[h];u+=l[0]*d,p+=d}var f=u/p,v=Math.abs(f),g=0,y=0;if(v>i)if(y=t+(f-i)/s*2*this.$scrollFactor,0>y||y>e)for(y=t;Math.abs(f)>i;)y-=f,f*=0>y||y>e?o*a:o,g++;else g=Math.log(i/v)/s;else y=t;g>0?(this.$bounces||(0>y?y=0:y>e&&(y=e)),this.throwTo(y,g)):this.finishScrolling()},u.prototype.onTick=function(t){if(!this.disposed){var n=t-this.previousTime;if(n>10){var r=this.previousVelocity;r.length>=e&&r.shift(),this.velocity=(this.currentPosition-this.previousPosition)/n,r.push(this.velocity),this.previousTime=t,this.previousPosition=this.currentPosition}return!0}},u.prototype.finishScrolling=function(t){var e=this.currentScrollPos,n=this.maxScrollPos,r=e;0>e&&(r=0),e>n&&(r=n),this.throwTo(r,300)},u.prototype.throwTo=function(t,e){void 0===e&&(e=500);var n=this.currentScrollPos;if(n==t)return void this.endFunction.call(this.target);var r=this.animation;r.duration=e,r.from=n,r.to=t,r.play()},u.prototype.onScrollingUpdate=function(t){this.disposed||(this.currentScrollPos=t.currentValue,this.updateFunction.call(this.target,t.currentValue))},u}();t.TouchScroll=u,__reflect(u.prototype,"cui.TouchScroll")}(cui||(cui={}));var TRain;!function(t){var e=function(){function t(){this._gpList={}}return t.prototype.getGp=function(t){return this._gpList[t]},t.prototype.getTxtByKey=function(t){var e=t.split("#"),n=this._gpList[e[0]];return n?n[e[1]]:void 0},t.prototype.getTxt=function(t,e){var n=this._gpList[t];return n?n[e]:void 0},t.prototype.getErrText=function(t){var e=this._errGp;return e?e[t]:(e=this._gpList.errCode,e?(this._errGp=e,e[t]):void 0)},t.prototype.addGps=function(t){var e=this._gpList;for(var n in t){var r=t[n],i=e[n];if(i)for(var o in r)i[o]=r[o];else e[n]=r}},t}();t.LangManager=e,__reflect(e.prototype,"TRain.LangManager"),t.langMgr=new e}(TRain||(TRain={}));var TRain;!function(t){var e=function(){function e(){var t=this;t._timeoutHandler=0,t._mcs=[]}return e.prototype.enableGC=function(){var e=this;0==e._timeoutHandler&&(e._disposeTp=0,e._timeoutHandler=t.core.addDelayDo(e.disposeRess,e,CONF.mcGCTm))},e.prototype.disableGC=function(){var e=this;0!==e._timeoutHandler&&(t.core.rmvDelayDoByID(e._timeoutHandler),e._timeoutHandler=0)},e.prototype.init=function(t,e){var n=this;n._armTps=t,n._oneUrl=e;for(var r=[],i=[],o=[],a=0,s=t.length;s>a;a++)r.push({}),i.push({}),o.push({});n._mcRess=r,n._usecnts=i,n._loadings=o},e.prototype.getMCUrl=function(t,e){return this._oneUrl?CONF.mcUrl+e+".mc":CONF.mcUrl+this._armTps[t]+"/"+e+".mc"},e.prototype.getMCRess=function(t,e,n,r){var i=this;n.push(i.getMCUrl(t,e)),r.push("mc")},e.prototype.incUsecnt=function(t,e){var n=this._usecnts[t];e in n?n[e]++:n[e]=1},e.prototype.decUsecnt=function(t,e){var n=this._usecnts[t];n.hasOwnProperty(e)&&n[e]--},e.prototype.getMCData=function(t,e,n){var r=this,i=r._mcRess[t][e];return i?r._getMCData(i,t,e,n):null},e.prototype.hasMCRes=function(t,e){return!!this._mcRess[t][e]},e.prototype._getMCData=function(e,n,r,i){i=i||"mc";var o=e.clips,a=o[i];if("undefined"==typeof a){var s=e.sheet;if(s){var u=e.conf[i],l=u.res||e.conf.res;a=new t.MovieClipData(u,l,s),a.resName=r,a.aniName=i,o[i]=a}else a=null,o[i]=a}return a&&this.incUsecnt(n,r),a},e.prototype.getMCDataAsync=function(e,n,r,i,o){var a=this,s=a._mcRess[e],u=s[n];if(u){var l=a._getMCData(u,e,n,o);return void t.core.addNextDo(r,i,l,e)}var c=function(t,e,n){var s=a._mcRess[e][n],u=a._getMCData(s,e,n,o);r.call(i,u,e)};a.loadRessImpl(e,n,c,a)},e.prototype.loadMCs=function(e,n,r,i){for(var o,a=this,s=e.length,u=[],l=0;s>l;++l)o=e[l],a.hasMCRes(o.mcTp,o.resName)||u.push(o);if(s=u.length,0==s)return void(null!=n&&t.core.addNextDo(n,r,!0,i));var c;if(null!=n){var p=!0,h=r;c=function(t,e,r){s--,t||(p=!1),0>=s&&n.call(h,p,i)},r=a}for(var l=0,d=s;d>l;++l)o=u[l],a.loadRessImpl(o.mcTp,o.resName,c,a)},e.prototype.loadMCRes=function(e,n,r,i){var o=this;return o.hasMCRes(e,n)?void(null!=r&&t.core.addNextDo(r,i,!0,e,n)):void o.loadRessImpl(e,n,r,i)},e.prototype.loadRessImpl=function(e,n,r,i){function o(t){a.onLoadArmResFin(t,e,n)}var a=this,s=a._loadings[e],u=s[n],l={callback:r,target:i};if(u)return void u.push(l);u=[l],s[n]=u;var c=a.getMCUrl(e,n);t.assetMgr.getTex(c,o,a,"mc")},e.prototype.onLoadArmResFin=function(t,e,n){var r=this,i=r._mcRess[e],o=i[n];if(!o){o={conf:null,sheet:null,clips:{}};var a=!!t;a&&(o.conf=t.conf,o.sheet=new egret.SpriteSheet(t)),i[n]=o;var s=r._loadings[e],u=s[n];delete s[n];for(var l=u.length-1;l>=0;--l){var c=u[l];c.callback.call(c.target,a,e,n)}}},e.prototype.freeMCData=function(t,e){this.decUsecnt(t,e.resName)},e.prototype.disposeRess=function(){var e=this,n=e._disposeTp,r=[],i=e._mcRess[n],o=e._usecnts[n];for(var a in o){var s=o[a];if(0>=s){var u=i[a];u.sheet&&(delete i[a],t.assetMgr.releaseTex(u.sheet.$texture),r.push(a))}}if(r.length>0)for(var l=0,c=r.length;c>l;++l)delete o[r[l]];n++,n<e._armTps.length?(e._disposeTp=n,e._timeoutHandler=t.core.addDelayDo(e.disposeRess,e,CONF.mcGCTm,0,!1)):(e._disposeTp=0,e._timeoutHandler=0)},e.prototype.add=function(t){var e=this._mcs;e.indexOf(t)>=0||e.push(t)},e.prototype.remove=function(t){var e=this._mcs,n=e.indexOf(t);n>=0&&e.splice(n,1)},e.prototype.advanceTime=function(t){var e=this._mcs,n=e.length;if(n>0)for(var r=n-1;r>=0;--r){var i=e[r];i&&i.advanceTime(t)}},e}();t.MCManager=e,__reflect(e.prototype,"TRain.MCManager"),t.mcMgr=new e}(TRain||(TRain={}));var TRain;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n.$MovieClip=[null,null,egret.Bitmap.defaultSmoothing,!1,0,0,0,0,0,0],n.$renderNode=new egret.sys.BitmapNode,e}return __extends(e,t),e.prototype.dispose=function(){var t=this.$MovieClip;t[0]=null,t[1]=null},Object.defineProperty(e.prototype,"smoothing",{get:function(){return this.$MovieClip[2]},set:function(t){t=!!t,this.$MovieClip[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this.$MovieClip[7]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.$MovieClip[8]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){var t=this.$MovieClip[4];return t>0?Math.floor(1e3/t):0},set:function(t){var e=0;if(0>=t)e=1e3/t;else{var n=this.$MovieClip[1];n&&(e=n.intervalTime)}this.$MovieClip[4]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var t=this.$MovieClip;return t[4]*t[7]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curSchedule",{get:function(){var t=this.$MovieClip;return t[4]*t[8]+t[9]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){var t=this.$MovieClip;return t[3]&&t[7]>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movieClipData",{get:function(){return this.$MovieClip[1]},set:function(t){var e=this,n=this.$MovieClip;n[1]!=t&&(n[6]=0,n[8]=0,n[9]=0,n[1]=t,t?(n[4]=t.intervalTime,n[7]=t.numFrames):(n[4]=0,n[7]=0),e.updateDisplay())},enumerable:!0,configurable:!0}),e.prototype.getFrameLabelByName=function(t){var e=this.$MovieClip[1];if(e){var n=e.labels;if(n)for(var r=null,i=0,o=n.length;o>i;i++)if(r=n[i],r.name==t)return r;return null}},e.prototype.getFrameLabelByFrame=function(t){var e=this.$MovieClip[1];if(e){var n=e.labels;if(n)for(var r=null,i=0;i<n.length;i++)if(r=n[i],r.frame==t)return r;return null}},e.prototype.getFrameLabelForFrame=function(t){var e=this.$MovieClip[1];if(!e)return null;var n=null,r=e.labels;if(r)for(var i=0;i<r.length;i++){var o=r[i];if(o.frame>t)return n;n=o}return n},e.prototype.setPlayLabel=function(t){var e=this.$MovieClip,n=e[1];if(!n)return null;var r=0,i=0;if(t){var o=n.labels;if(o)for(var a=null,s=0;s<o.length;s++)if(a=o[s],t==a.name){r=a.frame,i=a.end;break}}e[6]=r,0==i&&(i=n.numFrames-1);var u=i>r?i-r+1:0;e[7]=u,r!=e[8]&&(e[8]=r,this.updateDisplay())},e.prototype.stop=function(){this.$MovieClip[3]=!1},e.prototype.gotoAndPlay=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0/0);var n=this,r=n.$MovieClip,i=r[1];i&&(isNaN(e)&&(e=i.loop),r[3]=!0,r[5]=e,r[9]=0,n.gotoFrame(t))},e.prototype.gotoTmAndPlay=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0/0);var n=this,r=n.$MovieClip,i=r[1];if(i){isNaN(e)&&(e=i.loop),r[3]=!0,r[5]=e;var o=r[4],a=Math.floor(t/o);r[9]=t%o,n.gotoFrame(a%r[7])}},e.prototype.gotoAndStop=function(t){var e=this,n=e.$MovieClip;n[3]=!1,n[1]&&(n[9]=0,e.gotoFrame(t))},e.prototype.gotoFrame=function(t){var e=this.$MovieClip;if(0>t)t=0;else{var n=e[6],r=n+e[7]-1;t>r&&(t=r)}e[8]!=t&&(e[8]=t,this.updateDisplay())},e.prototype.advanceTime=function(t){var e=this,n=e.$MovieClip,r=n[7];if(n[3]&&r>0){var i=t+n[9],o=n[4],a=Math.floor(i/o);if(0>=a)return void(n[9]=i);n[9]=i%o;var s=n[6],u=s+r-1;a%=r;for(var l=n[8],c=n[1].events,p=[],h=n[5],d=!1,f=0;a>f;++f){if(l++,l>u)if(0>=h)p.push({type:egret.Event.LOOP_COMPLETE}),l=s;else{if(h--,!(h>0)){l=u,d=!0,p.push({type:egret.Event.COMPLETE});break}p.push({type:egret.Event.LOOP_COMPLETE,data:h}),l=s}if(c){var v=c[l];v&&p.push({type:"frame_label",data:v})}}if(n[5]=h,n[8]=l,e.updateDisplay(),d&&e.stop(),p.length>0)for(var g=p.length,f=0;g>f;++f){var y=p[f];e.dispatchEventWith(y.type,!1,y.data)}}},e.prototype.updateDisplay=function(){var t,e=this.$MovieClip,n=e[0],r=e[1];r&&(t=r.getFrameTex(e[8])),n!=t&&(e[0]=t,this.$renderDirty=!0)},e.prototype.$updateRenderNode=function(){var t=this,e=t.$MovieClip,n=e[0];if(n){var r=Math.round(n.$offsetX),i=Math.round(n.$offsetY),o=n.$bitmapWidth,a=n.$bitmapHeight,s=n.$getTextureWidth(),u=n.$getTextureHeight(),l=Math.round(n.$getScaleBitmapWidth()),c=Math.round(n.$getScaleBitmapHeight()),p=n.$sourceWidth,h=n.$sourceHeight;egret.sys.BitmapNode.$updateTextureData(t.$renderNode,n.$bitmapData,n.$bitmapX,n.$bitmapY,o,a,r,i,s,u,l,c,p,h,egret.BitmapFillMode.SCALE,e[2])}},e.prototype.$measureContentBounds=function(t){var e=this.$MovieClip[0];if(e){var n=e._offsetX,r=e._offsetY,i=e.$getTextureWidth(),o=e.$getTextureHeight();t.setTo(n,r,i,o)}else t.setEmpty()},e}(egret.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"TRain.MovieClip")}(TRain||(TRain={}));var TRain;!function(t){var e=function(){function t(t,e,n){var r=this;r.numFrames=0,r.loop=0,r.intervalTime=0,r.duration=0,r.frames=[],r._texData=e,r._sheet=n,t&&r.fillMCData(t)}return t.prototype.clone=function(e){var n=this,r=new t(null,n._texData,n._sheet);r.numFrames=n.numFrames,r.loop=n.loop,r.frameRate=n.frameRate,r.intervalTime=n.intervalTime,r.duration=n.duration;var i=n.frames.concat();return r.frames=e?i.reverse():i,r.labels=n.labels,r.events=n.events,r.aniName=n.aniName,r.resName=n.resName,r},t.prototype.getKeyFrame=function(t){return this.frames[t]},t.prototype.getFrameTex=function(t){var e=this.getKeyFrame(t);if(e.res){var n=this.getTex(e.res);return n.$offsetX=0|e.x,n.$offsetY=0|e.y,n}return null},t.prototype.getTex=function(t){var e=this,n=e._sheet.getTexture(t);if(!n){var r=e._texData[t];n=e._sheet.createTexture(t,r.x,r.y,r.w,r.h)}return n},t.prototype.fillMCData=function(t){var e=this,n=t.frameRate||24;e.frameRate=n,e.intervalTime=1e3/n,e.loop=t.loop||0,e.fillFramesData(t.frames),e.fillFramesEvent(t.events),e.labels=t.labels},t.prototype.fillFramesData=function(t){for(var e=this,n=e.frames,r=t?t.length:0,i=0;r>i;i++){var o=t[i];if(n.push(o),o.duration){var a=o.duration;if(a>1)for(var s=1;a>s;s++)n.push(o)}}r=n.length,e.numFrames=r,e.duration=r*e.intervalTime},t.prototype.fillFramesEvent=function(t){var e=t?t.length:0;if(e>0){for(var n={},r=0;e>r;r++){var i=t[r];n[i.frame]=i}this.events=n}},t}();t.MovieClipData=e,__reflect(e.prototype,"TRain.MovieClipData")}(TRain||(TRain={}));var cui;!function(t){t.htmlParser=new egret.HtmlTextParser,t.tempPt={x:0,y:0},t.tempRect={x:0,y:0,w:0,h:0}}(cui||(cui={}));var TRain;!function(t){var e=function(){function e(t){var e=this;e.name=t,e._cbs=[],e._subTexs={},e._refCnt=0}return e.prototype.getTexture=function(e,n,r){var i=this;if(!i._texData){var o=i._cbs;return o.push({name:e,comp:n,thisObj:r}),void(1===o.length&&t.assetMgr.getTex(CONF.sheetUrl+i.name+".st",i.loadImageSetFin,i,"st"))}var a=i._getTexture(e);n.call(r,a)},e.prototype._getTexture=function(e){var n=this,r=n._subTexs[e];if(!r){var i=n._texData,o=i.conf[e];if(o){if(r=new t.TexData,r.name=e,r.pname=n.name,r.$bitmapData=i.$bitmapData,0==e.indexOf("mk_"))0==e.indexOf("mk_h_")?r.$initData(o.x,o.y+1,o.w,o.h-2,o.ox,o.oy,o.sw,o.sh-2,i.$sourceWidth,i.$sourceHeight):0==e.indexOf("mk_w_")?r.$initData(o.x+1,o.y,o.w-2,o.h,o.ox,o.oy,o.sw-2,o.sh,i.$sourceWidth,i.$sourceHeight):r.$initData(o.x+1,o.y+1,o.w-2,o.h-2,o.ox,o.oy,o.sw-2,o.sh-2,i.$sourceWidth,i.$sourceHeight);else if(r.$initData(o.x,o.y,o.w,o.h,o.ox,o.oy,o.sw,o.sh,i.$sourceWidth,i.$sourceHeight),o.scale9grid){var a=o.scale9grid,s=a.split(",");r.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}n._subTexs[e]=r}}return r?(r.$addRef(),n._refCnt++):egret.log("subTexture not find  subname="+e+"  name="+n.name),r},e.prototype.loadImageSetFin=function(t){var e,n=this,r=n._cbs,i=r.length;if(t){n._texData=t;var o=n._subTexs,a=t.$bitmapData;for(var s in o){var u=o[s];u.$bitmapData=a}var l=0;for(l=0;i>l;++l)e=r[l],e.subTexData=n._getTexture(e.name);for(l=0;i>l;++l)e=r[l],e.comp.call(e.thisObj,e.subTexData)}else for(var l=0;i>l;++l)e=r[l],e.comp.call(e.thisObj,null);r.length=0},e.prototype.releaseBubTex=function(e){e.$subRef();var n=this;if(n._refCnt--,n._refCnt<=0){var r=n._subTexs;for(var i in r){var o=r[i];o.$bitmapData=null}e=n._texData,n._texData=null,t.assetMgr.releaseTex(e)}},e}();t.ImageSet=e,__reflect(e.prototype,"TRain.ImageSet")}(TRain||(TRain={}));var TRain;!function(TRain){var UITheme;!function(UITheme){function loadInitConf(t,e,n){_initFin=e,_initTar=n,RES.getResByUrl(t,onConfigLoaded,UITheme,RES.ResourceItem.TYPE_JSON)}function addSkinConf(t){var e=_skinConfs;for(var n in t)e[n]=t[n]}function mergeSkins(t){var e=_skinConfs;for(var n in t){var r=t[n];for(var i in r)e["skins."+n+"."+i]=r[i]}}function getSkin(t){var e=_skinMap[t];return e?e:parseSkin(t)}function onConfigLoaded(t,e){var n=this;addSkinConf(t),RES.destroyRes(e),egret.startTick(updateInitParse,n)}function onInited(){_initFin&&(_initFin.call(_initTar),_initFin=null,_initTar=null)}function updateInitParse(t){var e=this,n=_skinConfs,r=!1;for(var i in n){parseSkin(i),r=!0;break}return r||(onInited(),egret.stopTick(updateInitParse,e)),!1}function parseSkin(t){var e=_skinConfs,n=e[t];if(!n)return null;delete e[t],n=n.replace(/#!/g,"this."),n=n.replace(/#b/g,"function(");var r=parse(n);return _skinMap[t]=r,r}function parse(code){var clazz;try{clazz=eval(code),code=null}catch(e){return null}return clazz}var _skinMap={},_skinConfs={},_initFin,_initTar;UITheme.loadInitConf=loadInitConf,UITheme.addSkinConf=addSkinConf,UITheme.mergeSkins=mergeSkins,UITheme.getSkin=getSkin}(UITheme=TRain.UITheme||(TRain.UITheme={}))}(TRain||(TRain={}));var TRain;!function(t){var e=function(){function t(){}return t.prototype.fetchVersion=function(t){var e=this;if(e._verInfo||!CONF.verFile)return void t.onSuccess(null);e._cb=t;var n=new egret.HttpRequest;n.addEventListener(egret.Event.COMPLETE,e.onLoadFinish,e),n.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onLoadFinish,e),n.responseType=egret.HttpResponseType.TEXT,n.open(CONF.resHome+CONF.verFile),n.send()},t.prototype.onLoadFinish=function(t){var e=this,n=!1;if(t.type==egret.Event.COMPLETE)try{var r=t.target;e._verInfo=JSON.parse(r.response),n=!0}catch(i){egret.log("version parse fail")}else egret.log("version load fail");var o=e._cb;n?o.onSuccess(null):o.onFail(1,null),e._cb=null},t.prototype.addWebVer=function(t){var e=this._verInfo;for(var n in t){var r=t[n],i=e[n];if(i)for(var o in r)i[o]=i;else e[n]=r}},t.prototype.getChangeList=function(){return[]},t.prototype.getVirtualUrl=function(t){var e=t.lastIndexOf("."),n=t.substring(e+1);if(n.indexOf("?")>0)return CONF.resHome+t;var r=this._verInfo;if(r){var i=void 0,o=r[n];if(o){var a=t.substring(0,e);i=o[a]}else i=r.ver;if(i)return CONF.resHome+t.substring(0,e)+"_"+i+"."+n}return CONF.resHome+t},t}();t.WebVerController=e,__reflect(e.prototype,"TRain.WebVerController",["RES.VersionController","RES.IVersionController"])}(TRain||(TRain={}));var TRain;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setEaseFun=function(t){this._easeFun=t},e.prototype.update=function(t){var e=this,n=e._easeFun;n&&(t=n(t)),e.doUpdate(t)},e.prototype.doUpdate=function(t){},e}(t.Action);t.ActionTween=e,__reflect(e.prototype,"TRain.ActionTween");var n=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i._props=r,i}return __extends(e,t),e.prototype.setProps=function(t){this._props=t},e.prototype.addProp=function(t,e,n){var r=this._props;r||(r={},this._props=r),r[t]={b:e,r:n-e}},e.prototype.start=function(e){t.prototype.start.call(this,e);var n=this,r=n._props;if(r)for(var i in r)e[i]=r[i].b},e.prototype.doUpdate=function(t){var e=this,n=e._tar,r=e._props;for(var i in r){var o=r[i];n[i]=o.b+o.r*t}},e}(e);t.ActionPropTween=n,__reflect(n.prototype,"TRain.ActionPropTween");var r=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i._toProps=r,i}return __extends(e,t),e.prototype.setProps=function(t){this._toProps=t},e.prototype.addProp=function(t,e){var n=this._toProps;n||(n={},this._toProps=n),n[t]=e},e.prototype.start=function(e){t.prototype.start.call(this,e);var n=this,r=n._toProps,i={};if(r)for(var o in r){var a=e[o];i[o]={b:a,r:r[o]-a}}n._props=i},e.prototype.doUpdate=function(t){var e=this,n=e._tar,r=e._props;for(var i in r){var o=r[i];n[i]=o.b+o.r*t}},e}(e);t.ActionPropTo=r,__reflect(r.prototype,"TRain.ActionPropTo");var i=function(t){function e(e){var n=t.call(this)||this;return e&&n.setActions(e),n}return __extends(e,t),e.prototype.setActions=function(t){var e=this;e._actions=t,e._curIdx=0;for(var n=0,r=0,i=t.length;i>r;++r)n+=t[r].duration;e.duration=n},e.prototype.addAction=function(t){var e=this,n=e._actions;n||(n=[],e._actions=n),n.push(t);var r=e._dur+t.duration;e.duration=r},e.prototype.stop=function(){var e=this,n=e._actions;n.length>e._curIdx&&n[e._curIdx].stop(),t.prototype.stop.call(this)},e.prototype.stopToEnd=function(){for(var e=this,n=e._actions,r=e._curIdx,i=n.length;i>r;++r)n[r].stopToEnd();t.prototype.stop.call(this)},e.prototype.clear=function(){t.prototype.clear.call(this);for(var e=this,n=e._actions,r=0,i=n.length;i>r;++r)n[r].clear();n.length=0},e.prototype.start=function(e){t.prototype.start.call(this,e);var n=this,r=n._actions[0];r.start(e),n._lastSplit=0,n._curSplit=r.duration/n._dur,n._curIdx=0},e.prototype.update=function(t){for(var e=this,n=e._curIdx,r=e._actions;n<r.length;){var i=r[n],o=e._curSplit+e._lastSplit;if(!(t>=o)){i.update((t-e._lastSplit)/e._curSplit);break}if(i.update(1),i.stop(),n++,e._curIdx=n,n<r.length){var a=r[n];a.start(e._tar),e._lastSplit=o,e._curSplit=a.duration/e._dur}}},e}(e);t.ActionSequence=i,__reflect(i.prototype,"TRain.ActionSequence");var o=function(e){function n(t){var n=e.call(this)||this;return t&&n.setActions(t),n}return __extends(n,e),n.prototype.setActions=function(e){for(var n,r=this,o=0,a=0,s=e.length;s>a;++a)n=e[a],o<n.duration&&(o=n.duration);var u,l,c=[];for(a=0;s>a;++a)n=e[a],n.duration<o?(u=new i,l=new t.Action,l.duration=o-n.duration,u.setActions([n,l]),c.push(u)):c.push(n);r._actions=c,r.duration=o},n.prototype.stop=function(){for(var t=this._actions,n=0,r=t.length;r>n;++n)t[n].stop();e.prototype.stop.call(this)},n.prototype.stopToEnd=function(){for(var t=this._actions,n=0,r=t.length;r>n;++n)t[n].stopToEnd();e.prototype.stop.call(this)},n.prototype.clear=function(){e.prototype.clear.call(this);for(var t=this,n=t._actions,r=0,i=n.length;i>r;++r)n[r].clear();n.length=0},n.prototype.start=function(t){e.prototype.start.call(this,t);for(var n=this._actions,r=0,i=n.length;i>r;++r)n[r].start(t)},n.prototype.update=function(t){for(var e=this._actions,n=0,r=e.length;r>n;++n)e[n].update(t)},n}(e);t.ActionSpawn=o,__reflect(o.prototype,"TRain.ActionSpawn")}(TRain||(TRain={})),egret.BitmapFont.prototype.getTexture=function(t){var e=this,n=e._textureMap[t];if(!n){var r=e.charList[t];if(!r){var i=e.charTrans;i&&(r=e.charList[i[t]])}r&&(n=e.createTexture(t,r.x,r.y,r.w,r.h,r.ox,r.oy,r.sw,r.sh),e._textureMap[t]=n)}return n},egret.BitmapFont.prototype._getFirstCharHeight=function(){var t=this;if(0==t.firstCharHeight)for(var e in t.charList){var n=t.charList[e];if(n){var r=n.sw;if(void 0===r){var i=n.h;void 0===i&&(i=0);var o=n.oy;void 0===o&&(o=0),r=i+o}if(0>=r)continue;this.firstCharHeight=r;break}}return this.firstCharHeight};var TRain;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parseSpriteSheet=function(t,e,n,r){var i=JSON.parse(e),o=new egret.BitmapFont(t,i);r&&(o.charTrans=JSON.parse(r)),this.fileDic[n]=o},e.prototype.destroyRes=function(t){var e=this.fileDic,n=e[t];return n?(delete e[t],n.dispose(),!0):!1},e}(t.SheetAnalyzer);t.FontAnalyzer=e,__reflect(e.prototype,"TRain.FontAnalyzer"),RES.registerAnalyzer("fnt",e)}(TRain||(TRain={}));var TRain;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parseSpriteSheet=function(t,e,n){var r=JSON.parse(e);t.name=n,t.conf=r,this.fileDic[n]=t},e}(t.SheetAnalyzer);t.MCAnalyzer=e,__reflect(e.prototype,"TRain.MCAnalyzer"),RES.registerAnalyzer("mc",e)}(TRain||(TRain={}));var TRain;!function(t){var e=function(){function e(){var t=this;t._curMusic={sound:null,channel:null},t._sfxs=new CMap,t._plays=new CMap}return Object.defineProperty(e.prototype,"musicState",{get:function(){return this._musicState},set:function(t){var e=this;e._musicState!=t&&(e._musicState=t,t?e.playMusic(e._musicNm,!0):e.stopMusic())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sfxState",{get:function(){return this._sfxState},set:function(t){var e=this;e._sfxState!=t&&(e._sfxState=t,t||e.stopAllSFX())},enumerable:!0,configurable:!0}),e.prototype.getUrl=function(t){return CONF.soundUrl+t+".mp3"},e.prototype.playMusic=function(t,e){var n=this;if(t&&(n._musicNm!=t||e)&&(n._musicNm=t,n._musicState)){n.stopMusic();var r=new egret.Sound;r.addEventListener(egret.Event.COMPLETE,function(e){var r=e.target;if(t!=n._musicNm)return void r.close();var i=n._curMusic,o=r.play();i.sound=r,i.channel=o},n),r.load(RES.$getVirtualUrl(n.getUrl(t)))}},e.prototype.stopMusic=function(){var t=this,e=t._curMusic;e.channel&&(e.channel.stop(),e.channel=null),e.sound&&(e.sound.close(),e.sound=null)},e.prototype.playSFX=function(n,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=this;if(!o._sfxState||!n)return 0;var a=e.UUID++,s={nm:n,delay:r,duration:i,uuid:a};return r>0?t.core.addDelayDo(o._playSfx,o,r,0,!1,s):o._playSfx(s),a},e.prototype.stopSFX=function(t){this.rmvChannelById(t)},e.prototype.stopAllSFX=function(){for(var t=this._sfxs,e=t.values,n=0,r=e.length;r>n;++n){var i=e[n];if(i.stoped=!0,i.loaded){for(var o=i.channels.values,a=0,s=o.length;s>a;++a){var u=o[a];u.stop()}i.sound.close()}}t.clear(),this._plays.clear()
},e.prototype._playSfx=function(e){var n=this;if(n._sfxState){var r=e.uuid,i=e.duration;i>0&&t.core.addDelayDo(n.rmvChannelById,n,i,0,!1,r);var o=e.nm,a=n._sfxs.get(o);if(a){if(!a.loaded)return;return void n.playImpl(a,1,e.uuid)}var s=new egret.Sound,u=new CMap;a={sound:s,channels:u,nm:o,loaded:!1,stoped:!1},n._sfxs.set(o,a),n.addChannel(a,null,r);var l=function(t){if(a.stoped)a.sound.close();else{a.loaded=!0;var e=a.channels;e.has(r)&&n.playImpl(a,1,r)}};s.addEventListener(egret.Event.COMPLETE,l,n);var c=n.getUrl(o);s.load(RES.$getVirtualUrl(c))}},e.prototype.playImpl=function(t,e,n){var r=this,i=t.sound.play(0,e);r.addChannel(t,i,n),i.uuid=n,i.addEventListener(egret.Event.SOUND_COMPLETE,r.onSoundComplete,r),t.channels.set(n,i)},e.prototype.addChannel=function(t,e,n){t.channels.set(n,e),this._plays.set(n,t)},e.prototype.rmvChannelById=function(t){var e=this._plays,n=e.get(t);if(n){var r=n.channels.get(t);r&&r.stop(),n.channels["delete"](t),e["delete"](t)}},e.prototype.onSoundComplete=function(t){this.rmvChannelById(t.target.uuid)},e.prototype.gcRess=function(){var t=this._sfxs,e=t.values,n=[],r=0;for(r=e.length-1;r>=0;--r){var i=e[r];i.channels.size<=0&&(i.sound.close(),n.push(i.nm))}var o=n.length;if(o>0)for(r=o;r>=0;--r)t["delete"](n[r])},e.UUID=1,e}();t.SoundManager=e,__reflect(e.prototype,"TRain.SoundManager"),t.soundMgr=new e}(TRain||(TRain={}));var cui;!function(t){var e=function(t){function e(){var e=t.call(this)||this,n=e;return n.scaleTime=60,n.smallRatio=.85,n.bigRatio=1.15,n.touchChildren=!1,n._touchCaptured=!1,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),e}return __extends(e,t),e.prototype.onPartAdded=function(){var t=this,e=t.skIcon,n=t._icon;n&&e&&(e.source=n);var r=t.skLabel;if(r){var i=t._label;if(i)r.text=i;else{var o=t._txtKey;o&&(r.txtKey=o)}}var a=t.skAniGp;a.x=Math.floor(.5*t.width),a.y=Math.floor(.5*t.height),a.anthorPerX=.5,a.anthorPerY=.5},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){var e=this;e._label=t;var n=e.skLabel;n&&(n.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"txtKey",{get:function(){return this._txtKey},set:function(t){var e=this;e._txtKey=t;var n=e.skLabel;n&&(n.txtKey=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){var e=this;e._icon=t;var n=e.skIcon;n&&(n.source=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!0,configurable:!0}),e.prototype.setTarget=function(t,e){this._cb={fun:t,tar:e}},e.prototype.$hitTest=function(t,e){var n=this;if(!n.touchEnabled||!n.visible)return null;var r=n.globalToLocal(t,e,egret.$TempPoint),i=egret.$TempRectangle.setTo(0,0,n.width,n.height);return i.contains(r.x,r.y)?n:null},e.prototype.onTouchBegin=function(t){var e=this;e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e);var n=e.$stage;n.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchFinish,e),e._tempStage=n,e._touchCaptured=!0,t.updateAfterEvent(),e.scaleSmall()},e.prototype.onTouchEnd=function(t){var e=this;e.onTouchFinish(),t.isDefaultPrevented()||(t.preventDefault(),e.buttonReleased())},e.prototype.onTouchFinish=function(){var t=this,e=t._tempStage;e&&(e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchFinish,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t._touchCaptured=!1,t.scaleBig(),t._tempStage=null)},e.prototype.buttonReleased=function(){var t=this,e=t._cb;e&&e.fun.call(e.tar,t);var n=t._sound;n&&TRain.soundMgr.playSFX(n)},e.prototype.scaleSmall=function(){var t=this,e=t.skAniGp;if(e){t.clearAction();var n=t.smallRatio,r=new TRain.ActionPropTo(t.scaleTime,1,{scaleX:n,scaleY:n});t._action=r,TRain.actionMgr.addAction(r,e,!1)}},e.prototype.scaleBig=function(){var t=this,e=t.skAniGp;if(e){t.clearAction();var n=t.bigRatio,r=t.scaleTime,i=new TRain.ActionPropTo(2*r,1,{scaleX:n,scaleY:n}),o=new TRain.ActionPropTo(r,1,{scaleX:1,scaleY:1}),a=t._action=new TRain.ActionSequence([i,o]);TRain.actionMgr.addAction(a,e,!1)}},e.prototype.clearAction=function(){var t=this._action;t&&(TRain.actionMgr.rmvAction(t),this._action=null)},e.prototype.dispose=function(){var e=this;e.clearAction(),e.onTouchFinish(),e._cb=null,t.prototype.dispose.call(this)},e}(t.Component);t.ScaleButton=e,__reflect(e.prototype,"cui.ScaleButton")}(cui||(cui={}));